

<!DOCTYPE html>
<html class="writer-html5" lang="ja" data-content_root="../../../">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>src.cog.inventory &mdash; myla_game 1.6 ドキュメント</title>
      <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../../../_static/css/theme.css?v=e59714d7" />

  
      <script src="../../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../../_static/documentation_options.js?v=044f9cdb"></script>
      <script src="../../../_static/doctools.js?v=9bcbadda"></script>
      <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="../../../_static/translations.js?v=4755f45a"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="索引" href="../../../genindex.html" />
    <link rel="search" title="検索" href="../../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../index.html" class="icon icon-home">
            myla_game
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../src.html">src package</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">myla_game</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../index.html">モジュールコード</a></li>
      <li class="breadcrumb-item active">src.cog.inventory</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>src.cog.inventory のソースコード</h1><div class="highlight"><pre>
<span></span><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">プレイヤーの所持品（キャラクター、武器、ストーン）を表示・管理するための</span>
<span class="sd">UIフローとコマンドを提供するCog。フィルター、ソート、ページネーション、</span>
<span class="sd">アイテム強化など、高度な機能を持つインタラクティブなインベントリを実装します。</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">__future__</span><span class="w"> </span><span class="kn">import</span> <span class="n">annotations</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Any</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">discord</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">discord</span><span class="w"> </span><span class="kn">import</span> <span class="n">app_commands</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">discord.ext</span><span class="w"> </span><span class="kn">import</span> <span class="n">commands</span><span class="p">,</span> <span class="n">tasks</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">..utils</span><span class="w"> </span><span class="kn">import</span> <span class="n">utils</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">..myla_game</span><span class="w"> </span><span class="kn">import</span> <span class="n">myla_game</span> <span class="k">as</span> <span class="n">game</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">random</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">aiofiles</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">json</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">asyncio</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">math</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">typing</span>


<div class="viewcode-block" id="CharacterInventory">
<a class="viewcode-back" href="../../../src.cog.html#src.cog.inventory.CharacterInventory">[ドキュメント]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">CharacterInventory</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    キャラクターインベントリのUIフローと状態を管理するクラス。</span>
<span class="sd">    ユーザーがコマンドを打つとこのクラスのインスタンスが生成され、</span>
<span class="sd">    インタラクションを通じて状態を変化させながら一連のUIを提供します。</span>
<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="CharacterInventory.ViewSelectCharacter">
<a class="viewcode-back" href="../../../src.cog.html#src.cog.inventory.CharacterInventory.ViewSelectCharacter">[ドキュメント]</a>
    <span class="k">class</span><span class="w"> </span><span class="nc">ViewSelectCharacter</span><span class="p">(</span><span class="n">discord</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">View</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;キャラクター一覧画面で表示されるViewコンポーネント。</span>
<span class="sd">        </span>
<span class="sd">        キャラクター選択ボタン、フィルター、ソート、ページネーション機能を提供します。</span>
<span class="sd">        &quot;&quot;&quot;</span>

<div class="viewcode-block" id="CharacterInventory.ViewSelectCharacter.ButtonSelectCharacter">
<a class="viewcode-back" href="../../../src.cog.html#src.cog.inventory.CharacterInventory.ViewSelectCharacter.ButtonSelectCharacter">[ドキュメント]</a>
        <span class="k">class</span><span class="w"> </span><span class="nc">ButtonSelectCharacter</span><span class="p">(</span><span class="n">discord</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">Button</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;一覧に表示される各キャラクターに対応する選択ボタン。&quot;&quot;&quot;</span>
            <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                         <span class="n">character</span><span class="p">,</span>
                         <span class="o">*</span><span class="p">,</span>
                         <span class="n">style</span><span class="p">:</span> <span class="n">discord</span><span class="o">.</span><span class="n">ButtonStyle</span> <span class="o">=</span> <span class="n">discord</span><span class="o">.</span><span class="n">ButtonStyle</span><span class="o">.</span><span class="n">secondary</span><span class="p">,</span>
                         <span class="n">label</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                         <span class="n">disabled</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                         <span class="n">custom_id</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                         <span class="n">url</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                         <span class="n">emoji</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">discord</span><span class="o">.</span><span class="n">Emoji</span> <span class="o">|</span> <span class="n">discord</span><span class="o">.</span><span class="n">PartialEmoji</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                         <span class="n">row</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">                </span><span class="sd">&quot;&quot;&quot;ButtonSelectCharacterのコンストラクタ。</span>
<span class="sd">                </span>
<span class="sd">                Args:</span>
<span class="sd">                    character (list): 選択対象のキャラクターデータ `[index, CharacterObject]`。</span>
<span class="sd">                &quot;&quot;&quot;</span>
                <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="n">style</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">,</span> <span class="n">disabled</span><span class="o">=</span><span class="n">disabled</span><span class="p">,</span> <span class="n">custom_id</span><span class="o">=</span><span class="n">custom_id</span><span class="p">,</span> <span class="n">url</span><span class="o">=</span><span class="n">url</span><span class="p">,</span> <span class="n">emoji</span><span class="o">=</span><span class="n">emoji</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="n">row</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">character</span> <span class="o">=</span> <span class="n">character</span>

<div class="viewcode-block" id="CharacterInventory.ViewSelectCharacter.ButtonSelectCharacter.callback">
<a class="viewcode-back" href="../../../src.cog.html#src.cog.inventory.CharacterInventory.ViewSelectCharacter.ButtonSelectCharacter.callback">[ドキュメント]</a>
            <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">callback</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">interaction</span><span class="p">:</span> <span class="n">discord</span><span class="o">.</span><span class="n">Interaction</span><span class="p">):</span>
<span class="w">                </span><span class="sd">&quot;&quot;&quot;キャラクター選択ボタンが押された際のコールバック。</span>
<span class="sd">                </span>
<span class="sd">                操作者が本人であることを確認し、キャラクター詳細画面に遷移します。</span>
<span class="sd">                &quot;&quot;&quot;</span>
                <span class="k">if</span> <span class="n">interaction</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">id</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">id</span><span class="p">:</span>
                    <span class="k">await</span> <span class="n">interaction</span><span class="o">.</span><span class="n">response</span><span class="o">.</span><span class="n">defer</span><span class="p">()</span>
                    <span class="k">return</span>

                <span class="c1"># 親オブジェクトの選択中キャラクターを更新</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">selected_character</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">character</span>
                <span class="c1"># 詳細画面を表示</span>
                <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">show_character</span><span class="p">(</span><span class="n">interaction</span><span class="p">)</span></div>
</div>



<div class="viewcode-block" id="CharacterInventory.ViewSelectCharacter.SelectFilter">
<a class="viewcode-back" href="../../../src.cog.html#src.cog.inventory.CharacterInventory.ViewSelectCharacter.SelectFilter">[ドキュメント]</a>
        <span class="k">class</span><span class="w"> </span><span class="nc">SelectFilter</span><span class="p">(</span><span class="n">discord</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">Select</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;レアリティ、職業、属性でキャラクターをフィルタリングするドロップダウンメニュー。&quot;&quot;&quot;</span>
<div class="viewcode-block" id="CharacterInventory.ViewSelectCharacter.SelectFilter.callback">
<a class="viewcode-back" href="../../../src.cog.html#src.cog.inventory.CharacterInventory.ViewSelectCharacter.SelectFilter.callback">[ドキュメント]</a>
            <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">callback</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">discord</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">Select</span><span class="p">,</span> <span class="n">interaction</span><span class="p">:</span> <span class="n">discord</span><span class="o">.</span><span class="n">Interaction</span><span class="p">):</span>
<span class="w">                </span><span class="sd">&quot;&quot;&quot;フィルターオプションが選択された際のコールバック。</span>
<span class="sd">                </span>
<span class="sd">                選択されたフィルター条件を親オブジェクトに保存し、一覧を更新します。</span>
<span class="sd">                &quot;&quot;&quot;</span>
                <span class="k">if</span> <span class="n">interaction</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">id</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">id</span><span class="p">:</span>
                    <span class="k">await</span> <span class="n">interaction</span><span class="o">.</span><span class="n">response</span><span class="o">.</span><span class="n">defer</span><span class="p">()</span>
                    <span class="k">return</span>

                <span class="c1"># 選択された値からフィルター条件を再構築</span>
                <span class="n">fil_rarity</span><span class="p">,</span> <span class="n">fil_job</span><span class="p">,</span> <span class="n">fil_elem</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">:</span>
                    <span class="n">cat</span><span class="p">,</span> <span class="nb">id</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
                    <span class="nb">id</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">id</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">cat</span> <span class="o">==</span> <span class="s2">&quot;rarity&quot;</span><span class="p">:</span> <span class="n">fil_rarity</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">id</span><span class="p">)</span>
                    <span class="k">elif</span> <span class="n">cat</span> <span class="o">==</span> <span class="s2">&quot;job&quot;</span><span class="p">:</span> <span class="n">fil_job</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">id</span><span class="p">)</span>
                    <span class="k">elif</span> <span class="n">cat</span> <span class="o">==</span> <span class="s2">&quot;elem&quot;</span><span class="p">:</span> <span class="n">fil_elem</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">id</span><span class="p">)</span>
                
                <span class="c1"># 親オブジェクトのフィルター情報を更新</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">filters</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">fil_rarity</span> <span class="o">=</span> <span class="n">fil_rarity</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">fil_job</span> <span class="o">=</span> <span class="n">fil_job</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">fil_elem</span> <span class="o">=</span> <span class="n">fil_elem</span>

                <span class="c1"># フィルターを適用して一覧を再表示</span>
                <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">update_chara_list</span><span class="p">(</span><span class="n">interaction</span><span class="p">)</span></div>
</div>



<div class="viewcode-block" id="CharacterInventory.ViewSelectCharacter.SelectSort">
<a class="viewcode-back" href="../../../src.cog.html#src.cog.inventory.CharacterInventory.ViewSelectCharacter.SelectSort">[ドキュメント]</a>
        <span class="k">class</span><span class="w"> </span><span class="nc">SelectSort</span><span class="p">(</span><span class="n">discord</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">Select</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;キャラクターのソート（並び替え）基準を選択するドロップダウンメニュー。&quot;&quot;&quot;</span>
<div class="viewcode-block" id="CharacterInventory.ViewSelectCharacter.SelectSort.callback">
<a class="viewcode-back" href="../../../src.cog.html#src.cog.inventory.CharacterInventory.ViewSelectCharacter.SelectSort.callback">[ドキュメント]</a>
            <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">callback</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">interaction</span><span class="p">:</span> <span class="n">discord</span><span class="o">.</span><span class="n">Interaction</span><span class="p">):</span>
<span class="w">                </span><span class="sd">&quot;&quot;&quot;ソート基準が選択された際のコールバック。</span>
<span class="sd">                </span>
<span class="sd">                選択されたソート基準を親オブジェクトに保存し、一覧を更新します。</span>
<span class="sd">                &quot;&quot;&quot;</span>
                <span class="k">if</span> <span class="n">interaction</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">id</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">id</span><span class="p">:</span>
                    <span class="k">await</span> <span class="n">interaction</span><span class="o">.</span><span class="n">response</span><span class="o">.</span><span class="n">defer</span><span class="p">()</span>
                    <span class="k">return</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">sort_cat</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">update_chara_list</span><span class="p">(</span><span class="n">interaction</span><span class="p">)</span></div>
</div>



<div class="viewcode-block" id="CharacterInventory.ViewSelectCharacter.ButtonTopPage">
<a class="viewcode-back" href="../../../src.cog.html#src.cog.inventory.CharacterInventory.ViewSelectCharacter.ButtonTopPage">[ドキュメント]</a>
        <span class="k">class</span><span class="w"> </span><span class="nc">ButtonTopPage</span><span class="p">(</span><span class="n">discord</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">Button</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;一覧の最初のページに移動するボタン。&quot;&quot;&quot;</span>
<div class="viewcode-block" id="CharacterInventory.ViewSelectCharacter.ButtonTopPage.callback">
<a class="viewcode-back" href="../../../src.cog.html#src.cog.inventory.CharacterInventory.ViewSelectCharacter.ButtonTopPage.callback">[ドキュメント]</a>
            <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">callback</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">interaction</span><span class="p">:</span> <span class="n">discord</span><span class="o">.</span><span class="n">Interaction</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">interaction</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">id</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">id</span><span class="p">:</span>
                    <span class="k">await</span> <span class="n">interaction</span><span class="o">.</span><span class="n">response</span><span class="o">.</span><span class="n">defer</span><span class="p">()</span>
                    <span class="k">return</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">current_page</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">show_chara_list</span><span class="p">(</span><span class="n">interaction</span><span class="p">)</span></div>
</div>



<div class="viewcode-block" id="CharacterInventory.ViewSelectCharacter.ButtonPrevPage">
<a class="viewcode-back" href="../../../src.cog.html#src.cog.inventory.CharacterInventory.ViewSelectCharacter.ButtonPrevPage">[ドキュメント]</a>
        <span class="k">class</span><span class="w"> </span><span class="nc">ButtonPrevPage</span><span class="p">(</span><span class="n">discord</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">Button</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;一覧の前のページに移動するボタン。&quot;&quot;&quot;</span>
<div class="viewcode-block" id="CharacterInventory.ViewSelectCharacter.ButtonPrevPage.callback">
<a class="viewcode-back" href="../../../src.cog.html#src.cog.inventory.CharacterInventory.ViewSelectCharacter.ButtonPrevPage.callback">[ドキュメント]</a>
            <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">callback</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">interaction</span><span class="p">:</span> <span class="n">discord</span><span class="o">.</span><span class="n">Interaction</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">interaction</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">id</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">id</span><span class="p">:</span>
                    <span class="k">await</span> <span class="n">interaction</span><span class="o">.</span><span class="n">response</span><span class="o">.</span><span class="n">defer</span><span class="p">()</span>
                    <span class="k">return</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">current_page</span> <span class="o">-=</span> <span class="mi">1</span>
                <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">show_chara_list</span><span class="p">(</span><span class="n">interaction</span><span class="p">)</span></div>
</div>

            

<div class="viewcode-block" id="CharacterInventory.ViewSelectCharacter.ButtonNextPage">
<a class="viewcode-back" href="../../../src.cog.html#src.cog.inventory.CharacterInventory.ViewSelectCharacter.ButtonNextPage">[ドキュメント]</a>
        <span class="k">class</span><span class="w"> </span><span class="nc">ButtonNextPage</span><span class="p">(</span><span class="n">discord</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">Button</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;一覧の次のページに移動するボタン。&quot;&quot;&quot;</span>
<div class="viewcode-block" id="CharacterInventory.ViewSelectCharacter.ButtonNextPage.callback">
<a class="viewcode-back" href="../../../src.cog.html#src.cog.inventory.CharacterInventory.ViewSelectCharacter.ButtonNextPage.callback">[ドキュメント]</a>
            <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">callback</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">interaction</span><span class="p">:</span> <span class="n">discord</span><span class="o">.</span><span class="n">Interaction</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">interaction</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">id</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">id</span><span class="p">:</span>
                    <span class="k">await</span> <span class="n">interaction</span><span class="o">.</span><span class="n">response</span><span class="o">.</span><span class="n">defer</span><span class="p">()</span>
                    <span class="k">return</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">current_page</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">show_chara_list</span><span class="p">(</span><span class="n">interaction</span><span class="p">)</span></div>
</div>

            

<div class="viewcode-block" id="CharacterInventory.ViewSelectCharacter.ButtonReverseSort">
<a class="viewcode-back" href="../../../src.cog.html#src.cog.inventory.CharacterInventory.ViewSelectCharacter.ButtonReverseSort">[ドキュメント]</a>
        <span class="k">class</span><span class="w"> </span><span class="nc">ButtonReverseSort</span><span class="p">(</span><span class="n">discord</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">Button</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;ソート順（昇順/降順）を切り替えるボタン。&quot;&quot;&quot;</span>
<div class="viewcode-block" id="CharacterInventory.ViewSelectCharacter.ButtonReverseSort.callback">
<a class="viewcode-back" href="../../../src.cog.html#src.cog.inventory.CharacterInventory.ViewSelectCharacter.ButtonReverseSort.callback">[ドキュメント]</a>
            <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">callback</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">interaction</span><span class="p">:</span> <span class="n">discord</span><span class="o">.</span><span class="n">Interaction</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">interaction</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">id</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">id</span><span class="p">:</span>
                    <span class="k">await</span> <span class="n">interaction</span><span class="o">.</span><span class="n">response</span><span class="o">.</span><span class="n">defer</span><span class="p">()</span>
                    <span class="k">return</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">sort_reverse</span> <span class="o">=</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">sort_reverse</span>
                <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">update_chara_list</span><span class="p">(</span><span class="n">interaction</span><span class="p">)</span></div>
</div>



        <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">:</span> <span class="s2">&quot;CharacterInventory&quot;</span><span class="p">,</span> <span class="n">character_list</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">],</span> <span class="o">*</span><span class="p">,</span> <span class="n">timeout</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="mi">180</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;ViewSelectCharacterのコンストラクタ。</span>
<span class="sd">            </span>
<span class="sd">            現在のインベントリ状態（ページ、フィルター、ソート）に基づいてUIを構築します。</span>
<span class="sd">            &quot;&quot;&quot;</span>
            <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">timeout</span><span class="o">=</span><span class="n">timeout</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">obj</span> <span class="o">=</span> <span class="n">obj</span>
            
            <span class="c1"># キャラクター選択ボタンを生成 (最大10個)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">list_button_select_character</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">character_list</span><span class="p">):</span>
                    <span class="n">button</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ButtonSelectCharacter</span><span class="p">(</span><span class="n">character_list</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">style</span><span class="o">=</span><span class="n">discord</span><span class="o">.</span><span class="n">ButtonStyle</span><span class="o">.</span><span class="n">blurple</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">character_list</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">button</span> <span class="o">=</span> <span class="n">discord</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="n">discord</span><span class="o">.</span><span class="n">ButtonStyle</span><span class="o">.</span><span class="n">gray</span><span class="p">,</span> <span class="n">disabled</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">add_item</span><span class="p">(</span><span class="n">button</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">list_button_select_character</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">button</span><span class="p">)</span>

            <span class="c1"># フィルター用セレクトメニューを生成</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">select_filter</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">SelectFilter</span><span class="p">(</span><span class="n">placeholder</span><span class="o">=</span><span class="s2">&quot;フィルター&quot;</span><span class="p">,</span> <span class="n">min_values</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">max_values</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">select_filter</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;フィルターなし&quot;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="s2">&quot;blank-0&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;blank-0&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">filters</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">select_filter</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;[レア度]⭐️⭐️⭐️&quot;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="s2">&quot;rarity-0&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;rarity-0&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">filters</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">select_filter</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;[レア度]⭐️⭐️⭐️⭐️&quot;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="s2">&quot;rarity-1&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;rarity-1&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">filters</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">select_filter</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;[レア度]⭐️⭐️⭐️⭐️⭐️&quot;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="s2">&quot;rarity-2&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;rarity-2&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">filters</span><span class="p">))</span>

            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">game</span><span class="o">.</span><span class="n">Job</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">select_filter</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;[職業]</span><span class="si">{</span><span class="n">j</span><span class="o">.</span><span class="n">name_ja</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;job-</span><span class="si">{</span><span class="n">j</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;job-</span><span class="si">{</span><span class="n">j</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s2">&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">filters</span><span class="p">))</span>

            <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">game</span><span class="o">.</span><span class="n">Element</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">select_filter</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;[属性]</span><span class="si">{</span><span class="n">e</span><span class="o">.</span><span class="n">name_ja</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;elem-</span><span class="si">{</span><span class="n">e</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;elem-</span><span class="si">{</span><span class="n">e</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s2">&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">filters</span><span class="p">))</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">add_item</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">select_filter</span><span class="p">)</span>

            <span class="c1"># ソート用セレクトメニューを生成</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">select_sort</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">SelectSort</span><span class="p">(</span><span class="n">placeholder</span><span class="o">=</span><span class="s2">&quot;ソート&quot;</span><span class="p">,</span> <span class="n">min_values</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">max_values</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">select_sort</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;ソート：レベル&quot;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="s2">&quot;lv-0&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;lv-0&quot;</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">sort_cat</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">select_sort</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;ソート：レア度&quot;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="s2">&quot;rarity-0&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;rarity-0&quot;</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">sort_cat</span><span class="p">))</span>

            <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">game</span><span class="o">.</span><span class="n">Status</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">select_sort</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;ソート：</span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">name_ja</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;status-</span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;status-</span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s2">&quot;</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">sort_cat</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_item</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">select_sort</span><span class="p">)</span>

            <span class="c1"># ページネーションボタンとソート順ボタンを生成</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_item</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ButtonTopPage</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;&lt;&lt;&quot;</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="n">discord</span><span class="o">.</span><span class="n">ButtonStyle</span><span class="o">.</span><span class="n">blurple</span><span class="p">,</span> <span class="n">disabled</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">current_page</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_item</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ButtonPrevPage</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;&lt;&quot;</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="n">discord</span><span class="o">.</span><span class="n">ButtonStyle</span><span class="o">.</span><span class="n">blurple</span><span class="p">,</span> <span class="n">disabled</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">current_page</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_item</span><span class="p">(</span><span class="n">discord</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">current_page</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2"> / </span><span class="si">{</span><span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">max_page</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">disabled</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="n">discord</span><span class="o">.</span><span class="n">ButtonStyle</span><span class="o">.</span><span class="n">gray</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_item</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ButtonNextPage</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;&gt;&quot;</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="n">discord</span><span class="o">.</span><span class="n">ButtonStyle</span><span class="o">.</span><span class="n">blurple</span><span class="p">,</span> <span class="n">disabled</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">current_page</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">max_page</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_item</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ButtonReverseSort</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39;ソート：昇&#39;</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">sort_reverse</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;ソート：降&#39;</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="n">discord</span><span class="o">.</span><span class="n">ButtonStyle</span><span class="o">.</span><span class="n">blurple</span><span class="p">))</span></div>



<div class="viewcode-block" id="CharacterInventory.ViewCharacter">
<a class="viewcode-back" href="../../../src.cog.html#src.cog.inventory.CharacterInventory.ViewCharacter">[ドキュメント]</a>
    <span class="k">class</span><span class="w"> </span><span class="nc">ViewCharacter</span><span class="p">(</span><span class="n">discord</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">View</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;キャラクター詳細画面で表示されるView。「戻る」「レベルアップ」ボタンを提供。&quot;&quot;&quot;</span>
        <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">:</span> <span class="s2">&quot;CharacterInventory&quot;</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">timeout</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="mi">180</span><span class="p">):</span>
            <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">timeout</span><span class="o">=</span><span class="n">timeout</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">obj</span> <span class="o">=</span> <span class="n">obj</span>

<div class="viewcode-block" id="CharacterInventory.ViewCharacter.ButtonBack">
<a class="viewcode-back" href="../../../src.cog.html#src.cog.inventory.CharacterInventory.ViewCharacter.ButtonBack">[ドキュメント]</a>
        <span class="nd">@discord</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">button</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;Back&quot;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="n">discord</span><span class="o">.</span><span class="n">ButtonStyle</span><span class="o">.</span><span class="n">gray</span><span class="p">)</span>
        <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">ButtonBack</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">int</span><span class="p">:</span> <span class="n">discord</span><span class="o">.</span><span class="n">Interaction</span><span class="p">,</span> <span class="n">button</span><span class="p">:</span> <span class="n">discord</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">Button</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;「戻る」ボタン。キャラクター一覧画面に戻ります。&quot;&quot;&quot;</span>
            <span class="k">if</span> <span class="nb">int</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">id</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">id</span><span class="p">:</span>
                <span class="k">await</span> <span class="nb">int</span><span class="o">.</span><span class="n">response</span><span class="o">.</span><span class="n">defer</span><span class="p">()</span>
                <span class="k">return</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">selected_character</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">show_chara_list</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span></div>


<div class="viewcode-block" id="CharacterInventory.ViewCharacter.ButtonLvUp">
<a class="viewcode-back" href="../../../src.cog.html#src.cog.inventory.CharacterInventory.ViewCharacter.ButtonLvUp">[ドキュメント]</a>
        <span class="nd">@discord</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">button</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;Level Up&quot;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="n">discord</span><span class="o">.</span><span class="n">ButtonStyle</span><span class="o">.</span><span class="n">blurple</span><span class="p">)</span>
        <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">ButtonLvUp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">int</span><span class="p">:</span> <span class="n">discord</span><span class="o">.</span><span class="n">Interaction</span><span class="p">,</span> <span class="n">button</span><span class="p">:</span> <span class="n">discord</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">Button</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;「レベルアップ」ボタン。レベルアップ画面に遷移します。&quot;&quot;&quot;</span>
            <span class="k">if</span> <span class="nb">int</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">id</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">id</span><span class="p">:</span>
                <span class="k">await</span> <span class="nb">int</span><span class="o">.</span><span class="n">response</span><span class="o">.</span><span class="n">defer</span><span class="p">()</span>
                <span class="k">return</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">exp_item_count</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">show_lvup_chara</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span></div>
</div>



<div class="viewcode-block" id="CharacterInventory.ViewLvUpCharacter">
<a class="viewcode-back" href="../../../src.cog.html#src.cog.inventory.CharacterInventory.ViewLvUpCharacter">[ドキュメント]</a>
    <span class="k">class</span><span class="w"> </span><span class="nc">ViewLvUpCharacter</span><span class="p">(</span><span class="n">discord</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">View</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;キャラクターレベルアップ画面のView。アイテム使用数の増減や確定ボタンを提供。&quot;&quot;&quot;</span>

<div class="viewcode-block" id="CharacterInventory.ViewLvUpCharacter.ModalInputCount">
<a class="viewcode-back" href="../../../src.cog.html#src.cog.inventory.CharacterInventory.ViewLvUpCharacter.ModalInputCount">[ドキュメント]</a>
        <span class="k">class</span><span class="w"> </span><span class="nc">ModalInputCount</span><span class="p">(</span><span class="n">discord</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">Modal</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;使用する経験値アイテムの数を直接入力するためのモーダル。&quot;&quot;&quot;</span>
            <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">:</span> <span class="s2">&quot;CharacterInventory&quot;</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
                <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">obj</span> <span class="o">=</span> <span class="n">obj</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">count</span> <span class="o">=</span> <span class="n">discord</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">TextInput</span><span class="p">(</span>
                    <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;使用する</span><span class="si">{</span><span class="n">game</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">get_item_data_by_id</span><span class="p">(</span><span class="mi">0</span><span class="p">)[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1">の数&#39;</span><span class="p">,</span>
                    <span class="n">style</span><span class="o">=</span><span class="n">discord</span><span class="o">.</span><span class="n">TextStyle</span><span class="o">.</span><span class="n">short</span><span class="p">,</span>
                    <span class="n">required</span><span class="o">=</span><span class="kc">True</span>
                <span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">add_item</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">count</span><span class="p">)</span>

<div class="viewcode-block" id="CharacterInventory.ViewLvUpCharacter.ModalInputCount.on_submit">
<a class="viewcode-back" href="../../../src.cog.html#src.cog.inventory.CharacterInventory.ViewLvUpCharacter.ModalInputCount.on_submit">[ドキュメント]</a>
            <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">on_submit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">interaction</span><span class="p">:</span> <span class="n">discord</span><span class="o">.</span><span class="n">Interaction</span><span class="p">):</span>
<span class="w">                </span><span class="sd">&quot;&quot;&quot;入力が送信された際の処理。&quot;&quot;&quot;</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">exp_item_count</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">calc_lvup</span><span class="p">(</span><span class="n">interaction</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">count</span><span class="o">.</span><span class="n">value</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">count</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">isdecimal</span><span class="p">()</span> <span class="k">else</span> <span class="mi">0</span><span class="p">)</span></div>
</div>


        <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">:</span> <span class="s2">&quot;CharacterInventory&quot;</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">timeout</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="mi">180</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;ViewLvUpCharacterのコンストラクタ。&quot;&quot;&quot;</span>
            <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">timeout</span><span class="o">=</span><span class="n">timeout</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">obj</span> <span class="o">=</span> <span class="n">obj</span>

        <span class="c1"># --- Button Callbacks for Level Up ---</span>
<div class="viewcode-block" id="CharacterInventory.ViewLvUpCharacter.ButtonSub10">
<a class="viewcode-back" href="../../../src.cog.html#src.cog.inventory.CharacterInventory.ViewLvUpCharacter.ButtonSub10">[ドキュメント]</a>
        <span class="nd">@discord</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">button</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;-10&quot;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="n">discord</span><span class="o">.</span><span class="n">ButtonStyle</span><span class="o">.</span><span class="n">blurple</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">ButtonSub10</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">int</span><span class="p">:</span> <span class="n">discord</span><span class="o">.</span><span class="n">Interaction</span><span class="p">,</span> <span class="n">button</span><span class="p">:</span> <span class="n">discord</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">Button</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">int</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">id</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">id</span><span class="p">:</span> <span class="k">await</span> <span class="nb">int</span><span class="o">.</span><span class="n">response</span><span class="o">.</span><span class="n">defer</span><span class="p">();</span> <span class="k">return</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">calc_lvup</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="o">-</span><span class="mi">10</span><span class="p">)</span></div>

        
<div class="viewcode-block" id="CharacterInventory.ViewLvUpCharacter.ButtonSub1">
<a class="viewcode-back" href="../../../src.cog.html#src.cog.inventory.CharacterInventory.ViewLvUpCharacter.ButtonSub1">[ドキュメント]</a>
        <span class="nd">@discord</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">button</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;-1&quot;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="n">discord</span><span class="o">.</span><span class="n">ButtonStyle</span><span class="o">.</span><span class="n">blurple</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">ButtonSub1</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">int</span><span class="p">:</span> <span class="n">discord</span><span class="o">.</span><span class="n">Interaction</span><span class="p">,</span> <span class="n">button</span><span class="p">:</span> <span class="n">discord</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">Button</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">int</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">id</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">id</span><span class="p">:</span> <span class="k">await</span> <span class="nb">int</span><span class="o">.</span><span class="n">response</span><span class="o">.</span><span class="n">defer</span><span class="p">();</span> <span class="k">return</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">calc_lvup</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span></div>

            
<div class="viewcode-block" id="CharacterInventory.ViewLvUpCharacter.ButtonInput">
<a class="viewcode-back" href="../../../src.cog.html#src.cog.inventory.CharacterInventory.ViewLvUpCharacter.ButtonInput">[ドキュメント]</a>
        <span class="nd">@discord</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">button</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;入力&quot;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="n">discord</span><span class="o">.</span><span class="n">ButtonStyle</span><span class="o">.</span><span class="n">blurple</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">ButtonInput</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">int</span><span class="p">:</span> <span class="n">discord</span><span class="o">.</span><span class="n">Interaction</span><span class="p">,</span> <span class="n">button</span><span class="p">:</span> <span class="n">discord</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">Button</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">int</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">id</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">id</span><span class="p">:</span> <span class="k">await</span> <span class="nb">int</span><span class="o">.</span><span class="n">response</span><span class="o">.</span><span class="n">defer</span><span class="p">();</span> <span class="k">return</span>
            <span class="k">await</span> <span class="nb">int</span><span class="o">.</span><span class="n">response</span><span class="o">.</span><span class="n">send_modal</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ModalInputCount</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;入力&quot;</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">180</span><span class="p">))</span></div>


<div class="viewcode-block" id="CharacterInventory.ViewLvUpCharacter.ButtonAdd1">
<a class="viewcode-back" href="../../../src.cog.html#src.cog.inventory.CharacterInventory.ViewLvUpCharacter.ButtonAdd1">[ドキュメント]</a>
        <span class="nd">@discord</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">button</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;+1&quot;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="n">discord</span><span class="o">.</span><span class="n">ButtonStyle</span><span class="o">.</span><span class="n">blurple</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">ButtonAdd1</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">int</span><span class="p">:</span> <span class="n">discord</span><span class="o">.</span><span class="n">Interaction</span><span class="p">,</span> <span class="n">button</span><span class="p">:</span> <span class="n">discord</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">Button</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">int</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">id</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">id</span><span class="p">:</span> <span class="k">await</span> <span class="nb">int</span><span class="o">.</span><span class="n">response</span><span class="o">.</span><span class="n">defer</span><span class="p">();</span> <span class="k">return</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">calc_lvup</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span></div>


<div class="viewcode-block" id="CharacterInventory.ViewLvUpCharacter.ButtonAdd10">
<a class="viewcode-back" href="../../../src.cog.html#src.cog.inventory.CharacterInventory.ViewLvUpCharacter.ButtonAdd10">[ドキュメント]</a>
        <span class="nd">@discord</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">button</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;+10&quot;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="n">discord</span><span class="o">.</span><span class="n">ButtonStyle</span><span class="o">.</span><span class="n">blurple</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">ButtonAdd10</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">int</span><span class="p">:</span> <span class="n">discord</span><span class="o">.</span><span class="n">Interaction</span><span class="p">,</span> <span class="n">button</span><span class="p">:</span> <span class="n">discord</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">Button</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">int</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">id</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">id</span><span class="p">:</span> <span class="k">await</span> <span class="nb">int</span><span class="o">.</span><span class="n">response</span><span class="o">.</span><span class="n">defer</span><span class="p">();</span> <span class="k">return</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">calc_lvup</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span></div>


<div class="viewcode-block" id="CharacterInventory.ViewLvUpCharacter.ButtonSub100">
<a class="viewcode-back" href="../../../src.cog.html#src.cog.inventory.CharacterInventory.ViewLvUpCharacter.ButtonSub100">[ドキュメント]</a>
        <span class="nd">@discord</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">button</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;-100&quot;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="n">discord</span><span class="o">.</span><span class="n">ButtonStyle</span><span class="o">.</span><span class="n">blurple</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">ButtonSub100</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">int</span><span class="p">:</span> <span class="n">discord</span><span class="o">.</span><span class="n">Interaction</span><span class="p">,</span> <span class="n">button</span><span class="p">:</span> <span class="n">discord</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">Button</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">int</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">id</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">id</span><span class="p">:</span> <span class="k">await</span> <span class="nb">int</span><span class="o">.</span><span class="n">response</span><span class="o">.</span><span class="n">defer</span><span class="p">();</span> <span class="k">return</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">calc_lvup</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="o">-</span><span class="mi">100</span><span class="p">)</span></div>


<div class="viewcode-block" id="CharacterInventory.ViewLvUpCharacter.ButtonBlank1">
<a class="viewcode-back" href="../../../src.cog.html#src.cog.inventory.CharacterInventory.ViewLvUpCharacter.ButtonBlank1">[ドキュメント]</a>
        <span class="nd">@discord</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">button</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="n">discord</span><span class="o">.</span><span class="n">ButtonStyle</span><span class="o">.</span><span class="n">gray</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">disabled</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">ButtonBlank1</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">int</span><span class="p">:</span> <span class="n">discord</span><span class="o">.</span><span class="n">Interaction</span><span class="p">,</span> <span class="n">button</span><span class="p">:</span> <span class="n">discord</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">Button</span><span class="p">):</span>
            <span class="k">await</span> <span class="nb">int</span><span class="o">.</span><span class="n">response</span><span class="o">.</span><span class="n">defer</span><span class="p">()</span></div>


<div class="viewcode-block" id="CharacterInventory.ViewLvUpCharacter.ButtonSubmit">
<a class="viewcode-back" href="../../../src.cog.html#src.cog.inventory.CharacterInventory.ViewLvUpCharacter.ButtonSubmit">[ドキュメント]</a>
        <span class="nd">@discord</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">button</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;確定&quot;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="n">discord</span><span class="o">.</span><span class="n">ButtonStyle</span><span class="o">.</span><span class="n">green</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">ButtonSubmit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">int</span><span class="p">:</span> <span class="n">discord</span><span class="o">.</span><span class="n">Interaction</span><span class="p">,</span> <span class="n">button</span><span class="p">:</span> <span class="n">discord</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">Button</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;「確定」ボタン。レベルアップ処理を実行します。&quot;&quot;&quot;</span>
            <span class="k">if</span> <span class="nb">int</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">id</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">id</span><span class="p">:</span> <span class="k">await</span> <span class="nb">int</span><span class="o">.</span><span class="n">response</span><span class="o">.</span><span class="n">defer</span><span class="p">();</span> <span class="k">return</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">lvup_chara</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span></div>


<div class="viewcode-block" id="CharacterInventory.ViewLvUpCharacter.ButtonBlank2">
<a class="viewcode-back" href="../../../src.cog.html#src.cog.inventory.CharacterInventory.ViewLvUpCharacter.ButtonBlank2">[ドキュメント]</a>
        <span class="nd">@discord</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">button</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="n">discord</span><span class="o">.</span><span class="n">ButtonStyle</span><span class="o">.</span><span class="n">gray</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">disabled</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">ButtonBlank2</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">int</span><span class="p">:</span> <span class="n">discord</span><span class="o">.</span><span class="n">Interaction</span><span class="p">,</span> <span class="n">button</span><span class="p">:</span> <span class="n">discord</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">Button</span><span class="p">):</span>
            <span class="k">await</span> <span class="nb">int</span><span class="o">.</span><span class="n">response</span><span class="o">.</span><span class="n">defer</span><span class="p">()</span></div>


<div class="viewcode-block" id="CharacterInventory.ViewLvUpCharacter.ButtonAdd100">
<a class="viewcode-back" href="../../../src.cog.html#src.cog.inventory.CharacterInventory.ViewLvUpCharacter.ButtonAdd100">[ドキュメント]</a>
        <span class="nd">@discord</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">button</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;+100&quot;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="n">discord</span><span class="o">.</span><span class="n">ButtonStyle</span><span class="o">.</span><span class="n">blurple</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">ButtonAdd100</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">int</span><span class="p">:</span> <span class="n">discord</span><span class="o">.</span><span class="n">Interaction</span><span class="p">,</span> <span class="n">button</span><span class="p">:</span> <span class="n">discord</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">Button</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">int</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">id</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">id</span><span class="p">:</span> <span class="k">await</span> <span class="nb">int</span><span class="o">.</span><span class="n">response</span><span class="o">.</span><span class="n">defer</span><span class="p">();</span> <span class="k">return</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">calc_lvup</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span></div>
</div>



    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;CharacterInventoryセッションを初期化します。&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">user</span><span class="p">:</span> <span class="n">discord</span><span class="o">.</span><span class="n">User</span> <span class="o">|</span> <span class="n">discord</span><span class="o">.</span><span class="n">Member</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">character_list</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># フィルター・ソート済みの全キャラリスト</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current_page</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">max_page</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">filters</span> <span class="o">=</span> <span class="p">[]</span>         <span class="c1"># 適用中のフィルター（UI表示用）</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fil_rarity</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fil_job</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fil_elem</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span> <span class="c1"># 適用中のフィルター（ロジック用）</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sort_cat</span> <span class="o">=</span> <span class="s2">&quot;lv-0&quot;</span>    <span class="c1"># 現在のソートカテゴリ</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sort_reverse</span> <span class="o">=</span> <span class="kc">True</span>  <span class="c1"># 降順ソートか</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">selected_character</span><span class="p">:</span> <span class="nb">list</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span> <span class="c1"># 詳細表示中のキャラクター</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">exp_item_count</span> <span class="o">=</span> <span class="mi">0</span>   <span class="c1"># レベルアップに使用するアイテム数</span>


<div class="viewcode-block" id="CharacterInventory.show_lvup_chara">
<a class="viewcode-back" href="../../../src.cog.html#src.cog.inventory.CharacterInventory.show_lvup_chara">[ドキュメント]</a>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">show_lvup_chara</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">int</span><span class="p">:</span> <span class="n">discord</span><span class="o">.</span><span class="n">Interaction</span><span class="p">,</span> <span class="n">lvup_count</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        キャラクターレベルアップ画面を表示または更新します。</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            int (discord.Interaction): インタラクション。</span>
<span class="sd">            lvup_count (int): 計算後のレベル上昇量。</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">index</span><span class="p">,</span> <span class="n">chara</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">selected_character</span>
        <span class="n">embed</span> <span class="o">=</span> <span class="n">discord</span><span class="o">.</span><span class="n">Embed</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;[レベルアップ] </span><span class="si">{</span><span class="n">index</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s1">. </span><span class="si">{</span><span class="n">chara</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> 
                              <span class="n">description</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;使用する</span><span class="si">{</span><span class="n">game</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">get_item_data_by_id</span><span class="p">(</span><span class="mi">0</span><span class="p">)[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1">の数：**</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">exp_item_count</span><span class="si">}</span><span class="s1">** / </span><span class="si">{</span><span class="n">game</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">get_player_item_count</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span>
                              <span class="n">color</span><span class="o">=</span><span class="n">discord</span><span class="o">.</span><span class="n">Colour</span><span class="o">.</span><span class="n">from_rgb</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">))</span>
        <span class="n">embed</span><span class="o">.</span><span class="n">add_field</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;レベル&quot;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">chara</span><span class="o">.</span><span class="n">lv</span><span class="si">}</span><span class="s1"> &gt;&gt; </span><span class="si">{</span><span class="n">chara</span><span class="o">.</span><span class="n">lv</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">lvup_count</span><span class="si">}</span><span class="s1"> / </span><span class="si">{</span><span class="n">game</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">get_player_level</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">id</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">view</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ViewLvUpCharacter</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">await</span> <span class="nb">int</span><span class="o">.</span><span class="n">response</span><span class="o">.</span><span class="n">edit_message</span><span class="p">(</span><span class="n">embed</span><span class="o">=</span><span class="n">embed</span><span class="p">,</span> <span class="n">attachments</span><span class="o">=</span><span class="p">[],</span> <span class="n">view</span><span class="o">=</span><span class="n">view</span><span class="p">)</span></div>



<div class="viewcode-block" id="CharacterInventory.calc_lvup">
<a class="viewcode-back" href="../../../src.cog.html#src.cog.inventory.CharacterInventory.calc_lvup">[ドキュメント]</a>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">calc_lvup</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">interaction</span><span class="p">:</span> <span class="n">discord</span><span class="o">.</span><span class="n">Interaction</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        レベルアップに使用する経験値アイテムの数を計算し、画面を更新します。</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            interaction (discord.Interaction): インタラクション。</span>
<span class="sd">            value (int): 増減させるアイテム数。</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">index</span><span class="p">,</span> <span class="n">chara</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">selected_character</span>
        <span class="c1"># myla_game.utilsの計算関数を呼び出す</span>
        <span class="n">lvup_count</span><span class="p">,</span> <span class="n">exp_item_count</span> <span class="o">=</span> <span class="n">game</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">calc_character_lvup</span><span class="p">(</span><span class="n">chara</span><span class="o">.</span><span class="n">lv</span><span class="p">,</span> <span class="n">chara</span><span class="o">.</span><span class="n">exp</span><span class="p">,</span> <span class="n">game</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">get_player_level</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">id</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">exp_item_count</span> <span class="o">+</span> <span class="n">value</span><span class="p">,</span> <span class="n">game</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">get_player_item_count</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="mi">0</span><span class="p">)),</span> <span class="mi">0</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">exp_item_count</span> <span class="o">=</span> <span class="n">exp_item_count</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">show_lvup_chara</span><span class="p">(</span><span class="n">interaction</span><span class="p">,</span> <span class="n">lvup_count</span><span class="p">)</span></div>



<div class="viewcode-block" id="CharacterInventory.lvup_chara">
<a class="viewcode-back" href="../../../src.cog.html#src.cog.inventory.CharacterInventory.lvup_chara">[ドキュメント]</a>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">lvup_chara</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">int</span><span class="p">:</span> <span class="n">discord</span><span class="o">.</span><span class="n">Interaction</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;キャラクターのレベルアップを確定させ、データを更新します。&quot;&quot;&quot;</span>
        <span class="c1"># アイテムが足りているか最終チェック</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">game</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">give_item</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">exp_item_count</span><span class="p">):</span>
            <span class="nb">int</span><span class="o">.</span><span class="n">response</span><span class="o">.</span><span class="n">send_message</span><span class="p">(</span><span class="s2">&quot;アイテムが足りません&quot;</span><span class="p">,</span> <span class="n">ephemeral</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="n">index</span><span class="p">,</span> <span class="n">chara</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">selected_character</span>
        <span class="c1"># 経験値を付与</span>
        <span class="n">game</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">give_character_exp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">chara</span><span class="o">.</span><span class="n">uuid</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">exp_item_count</span> <span class="o">*</span> <span class="mi">100</span><span class="p">)</span>

        <span class="c1"># キャラクターデータを再取得して更新</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">selected_character</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">game</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">get_player_character</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">chara</span><span class="o">.</span><span class="n">uuid</span><span class="p">)</span>
        
        <span class="c1"># 詳細画面に戻る</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">show_character</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span></div>



<div class="viewcode-block" id="CharacterInventory.show_character">
<a class="viewcode-back" href="../../../src.cog.html#src.cog.inventory.CharacterInventory.show_character">[ドキュメント]</a>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">show_character</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">int</span><span class="p">:</span> <span class="n">discord</span><span class="o">.</span><span class="n">Interaction</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;選択されたキャラクターの詳細画面を表示します。&quot;&quot;&quot;</span>
        <span class="n">index</span><span class="p">,</span> <span class="n">chara</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">selected_character</span>
        
        <span class="c1"># レアリティに応じたEmbedを作成</span>
        <span class="n">rarity_map</span> <span class="o">=</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;⭐️⭐️⭐️&quot;</span><span class="p">,</span> <span class="n">discord</span><span class="o">.</span><span class="n">Colour</span><span class="o">.</span><span class="n">from_rgb</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">127</span><span class="p">)),</span>
                      <span class="mi">1</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;⭐️⭐️⭐️⭐️&quot;</span><span class="p">,</span> <span class="n">discord</span><span class="o">.</span><span class="n">Colour</span><span class="o">.</span><span class="n">from_rgb</span><span class="p">(</span><span class="mi">127</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">)),</span>
                      <span class="mi">2</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;⭐️⭐️⭐️⭐️⭐️&quot;</span><span class="p">,</span> <span class="n">discord</span><span class="o">.</span><span class="n">Colour</span><span class="o">.</span><span class="n">from_rgb</span><span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">0</span><span class="p">))}</span>
        <span class="n">rarity_desc</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="n">rarity_map</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">chara</span><span class="o">.</span><span class="n">rarity</span><span class="p">,</span> <span class="p">(</span><span class="s2">&quot;レア度なし&quot;</span><span class="p">,</span> <span class="n">discord</span><span class="o">.</span><span class="n">Colour</span><span class="o">.</span><span class="n">from_rgb</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)))</span>
        <span class="n">embed</span> <span class="o">=</span> <span class="n">discord</span><span class="o">.</span><span class="n">Embed</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">index</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s1">. </span><span class="si">{</span><span class="n">chara</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="n">rarity_desc</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>

        <span class="c1"># ステータス等の情報をフィールドに追加</span>
        <span class="n">embed</span><span class="o">.</span><span class="n">add_field</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;レベル&quot;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">chara</span><span class="o">.</span><span class="n">lv</span><span class="si">}</span><span class="s1"> / </span><span class="si">{</span><span class="n">game</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">get_player_level</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">id</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">embed</span><span class="o">.</span><span class="n">add_field</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;ステータス&quot;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">game</span><span class="o">.</span><span class="n">Status</span><span class="o">.</span><span class="n">HP</span><span class="o">.</span><span class="n">name_ja</span><span class="si">}</span><span class="s1">：</span><span class="si">{</span><span class="n">game</span><span class="o">.</span><span class="n">Status</span><span class="o">.</span><span class="n">HP</span><span class="o">.</span><span class="n">get_display_value</span><span class="p">(</span><span class="n">chara</span><span class="o">.</span><span class="n">status</span><span class="p">[</span><span class="n">game</span><span class="o">.</span><span class="n">Status</span><span class="o">.</span><span class="n">HP</span><span class="o">.</span><span class="n">id</span><span class="p">])</span><span class="si">}</span><span class="se">\n</span><span class="si">{</span><span class="n">game</span><span class="o">.</span><span class="n">Status</span><span class="o">.</span><span class="n">ATK</span><span class="o">.</span><span class="n">name_ja</span><span class="si">}</span><span class="s1">：</span><span class="si">{</span><span class="n">game</span><span class="o">.</span><span class="n">Status</span><span class="o">.</span><span class="n">ATK</span><span class="o">.</span><span class="n">get_display_value</span><span class="p">(</span><span class="n">chara</span><span class="o">.</span><span class="n">status</span><span class="p">[</span><span class="n">game</span><span class="o">.</span><span class="n">Status</span><span class="o">.</span><span class="n">ATK</span><span class="o">.</span><span class="n">id</span><span class="p">])</span><span class="si">}</span><span class="se">\n</span><span class="si">{</span><span class="n">game</span><span class="o">.</span><span class="n">Status</span><span class="o">.</span><span class="n">DEF</span><span class="o">.</span><span class="n">name_ja</span><span class="si">}</span><span class="s1">：</span><span class="si">{</span><span class="n">game</span><span class="o">.</span><span class="n">Status</span><span class="o">.</span><span class="n">DEF</span><span class="o">.</span><span class="n">get_display_value</span><span class="p">(</span><span class="n">chara</span><span class="o">.</span><span class="n">status</span><span class="p">[</span><span class="n">game</span><span class="o">.</span><span class="n">Status</span><span class="o">.</span><span class="n">DEF</span><span class="o">.</span><span class="n">id</span><span class="p">])</span><span class="si">}</span><span class="se">\n</span><span class="si">{</span><span class="n">game</span><span class="o">.</span><span class="n">Status</span><span class="o">.</span><span class="n">C_RATE</span><span class="o">.</span><span class="n">name_ja</span><span class="si">}</span><span class="s1">：</span><span class="si">{</span><span class="n">game</span><span class="o">.</span><span class="n">Status</span><span class="o">.</span><span class="n">C_RATE</span><span class="o">.</span><span class="n">get_display_value</span><span class="p">(</span><span class="n">chara</span><span class="o">.</span><span class="n">status</span><span class="p">[</span><span class="n">game</span><span class="o">.</span><span class="n">Status</span><span class="o">.</span><span class="n">C_RATE</span><span class="o">.</span><span class="n">id</span><span class="p">])</span><span class="si">}</span><span class="se">\n</span><span class="si">{</span><span class="n">game</span><span class="o">.</span><span class="n">Status</span><span class="o">.</span><span class="n">C_DMG</span><span class="o">.</span><span class="n">name_ja</span><span class="si">}</span><span class="s1">：</span><span class="si">{</span><span class="n">game</span><span class="o">.</span><span class="n">Status</span><span class="o">.</span><span class="n">C_DMG</span><span class="o">.</span><span class="n">get_display_value</span><span class="p">(</span><span class="n">chara</span><span class="o">.</span><span class="n">status</span><span class="p">[</span><span class="n">game</span><span class="o">.</span><span class="n">Status</span><span class="o">.</span><span class="n">C_DMG</span><span class="o">.</span><span class="n">id</span><span class="p">])</span><span class="si">}</span><span class="se">\n</span><span class="si">{</span><span class="n">game</span><span class="o">.</span><span class="n">Status</span><span class="o">.</span><span class="n">SPD</span><span class="o">.</span><span class="n">name_ja</span><span class="si">}</span><span class="s1">：</span><span class="si">{</span><span class="n">game</span><span class="o">.</span><span class="n">Status</span><span class="o">.</span><span class="n">SPD</span><span class="o">.</span><span class="n">get_display_value</span><span class="p">(</span><span class="n">chara</span><span class="o">.</span><span class="n">status</span><span class="p">[</span><span class="n">game</span><span class="o">.</span><span class="n">Status</span><span class="o">.</span><span class="n">SPD</span><span class="o">.</span><span class="n">id</span><span class="p">])</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">embed</span><span class="o">.</span><span class="n">add_field</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;職業&quot;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">chara</span><span class="o">.</span><span class="n">job</span><span class="o">.</span><span class="n">name_ja</span><span class="p">)</span>
        <span class="n">embed</span><span class="o">.</span><span class="n">add_field</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;属性&quot;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">chara</span><span class="o">.</span><span class="n">elem</span><span class="o">.</span><span class="n">name_ja</span><span class="p">)</span>
        <span class="n">embed</span><span class="o">.</span><span class="n">add_field</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;凸数&quot;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">chara</span><span class="o">.</span><span class="n">count</span><span class="p">)</span>


        <span class="c1"># キャラクター画像を設定</span>
        <span class="n">chara_data</span> <span class="o">=</span> <span class="n">game</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">get_character_data_by_id</span><span class="p">(</span><span class="n">chara</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
        <span class="n">file</span> <span class="o">=</span> <span class="n">discord</span><span class="o">.</span><span class="n">File</span><span class="p">(</span><span class="n">fp</span><span class="o">=</span><span class="n">utils</span><span class="o">.</span><span class="n">sys</span><span class="o">.</span><span class="n">get_game_path</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;asset/img/</span><span class="si">{</span><span class="n">chara_data</span><span class="p">[</span><span class="s2">&quot;img_path&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">),</span> <span class="n">filename</span><span class="o">=</span><span class="s2">&quot;character.png&quot;</span><span class="p">)</span>
        <span class="n">embed</span><span class="o">.</span><span class="n">set_image</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="s2">&quot;attachment://character.png&quot;</span><span class="p">)</span>

        <span class="n">view</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ViewCharacter</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">await</span> <span class="nb">int</span><span class="o">.</span><span class="n">response</span><span class="o">.</span><span class="n">edit_message</span><span class="p">(</span><span class="n">embed</span><span class="o">=</span><span class="n">embed</span><span class="p">,</span> <span class="n">attachments</span><span class="o">=</span><span class="p">[</span><span class="n">file</span><span class="p">],</span> <span class="n">view</span><span class="o">=</span><span class="n">view</span><span class="p">)</span></div>



<div class="viewcode-block" id="CharacterInventory.show_chara_list">
<a class="viewcode-back" href="../../../src.cog.html#src.cog.inventory.CharacterInventory.show_chara_list">[ドキュメント]</a>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">show_chara_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">interaction</span><span class="p">:</span> <span class="n">discord</span><span class="o">.</span><span class="n">Interaction</span><span class="p">,</span> <span class="n">is_send</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        キャラクター一覧の指定されたページを表示します。</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            interaction (discord.Interaction): インタラクション。</span>
<span class="sd">            is_send (bool): 新規メッセージとして送信するかどうか。</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># 現在のページのキャラクターリストをスライス</span>
        <span class="n">chara_list_page</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">character_list</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">current_page</span> <span class="o">*</span> <span class="mi">10</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_page</span> <span class="o">*</span> <span class="mi">10</span> <span class="o">+</span> <span class="mi">10</span><span class="p">]</span>

        <span class="c1"># Embedのdescriptionにキャラクターリストを作成</span>
        <span class="n">description</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="sa">f</span><span class="s1">&#39;**</span><span class="si">{</span><span class="n">c</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s1">.** </span><span class="si">{</span><span class="n">c</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s1"> lv.</span><span class="si">{</span><span class="n">c</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">lv</span><span class="si">}</span><span class="se">\\</span><span class="s1">n&#39;</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">chara_list_page</span><span class="p">])</span>
        <span class="n">embed</span> <span class="o">=</span> <span class="n">discord</span><span class="o">.</span><span class="n">Embed</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;所持キャラクター一覧&quot;</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="n">description</span><span class="o">.</span><span class="n">rstrip</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">n&quot;</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="n">discord</span><span class="o">.</span><span class="n">Colour</span><span class="o">.</span><span class="n">from_rgb</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">))</span>

        <span class="n">view</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ViewSelectCharacter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">chara_list_page</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">is_send</span><span class="p">:</span>
            <span class="k">await</span> <span class="n">interaction</span><span class="o">.</span><span class="n">response</span><span class="o">.</span><span class="n">send_message</span><span class="p">(</span><span class="n">embed</span><span class="o">=</span><span class="n">embed</span><span class="p">,</span> <span class="n">view</span><span class="o">=</span><span class="n">view</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">await</span> <span class="n">interaction</span><span class="o">.</span><span class="n">response</span><span class="o">.</span><span class="n">edit_message</span><span class="p">(</span><span class="n">embed</span><span class="o">=</span><span class="n">embed</span><span class="p">,</span> <span class="n">attachments</span><span class="o">=</span><span class="p">[],</span> <span class="n">view</span><span class="o">=</span><span class="n">view</span><span class="p">)</span></div>



<div class="viewcode-block" id="CharacterInventory.update_chara_list">
<a class="viewcode-back" href="../../../src.cog.html#src.cog.inventory.CharacterInventory.update_chara_list">[ドキュメント]</a>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">update_chara_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">interaction</span><span class="p">:</span> <span class="n">discord</span><span class="o">.</span><span class="n">Interaction</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        フィルターやソートの変更を反映して、キャラクター一覧を再生成・表示します。</span>
<span class="sd">        このメソッドがインベントリの初期表示にも使われます。</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">is_send</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">user</span> <span class="ow">is</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">is_send</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">user</span> <span class="o">=</span> <span class="n">interaction</span><span class="o">.</span><span class="n">user</span>

        <span class="c1"># プレイヤーの全キャラクターデータを取得</span>
        <span class="n">all_charas_data</span> <span class="o">=</span> <span class="n">game</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">get_player_all_characters_data</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
        <span class="n">character_list</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="c1"># フィルターを適用</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">all_charas_data</span><span class="p">):</span>
            <span class="n">c_data</span> <span class="o">=</span> <span class="n">game</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">get_character_data_by_id</span><span class="p">(</span><span class="n">c</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">])</span>
            <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">fil_rarity</span> <span class="ow">or</span> <span class="n">c_data</span><span class="p">[</span><span class="s2">&quot;rarity&quot;</span><span class="p">]</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fil_rarity</span><span class="p">)</span> <span class="ow">and</span> \
               <span class="p">(</span><span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">fil_job</span> <span class="ow">or</span> <span class="n">c_data</span><span class="p">[</span><span class="s2">&quot;job&quot;</span><span class="p">]</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fil_job</span><span class="p">)</span> <span class="ow">and</span> \
               <span class="p">(</span><span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">fil_elem</span> <span class="ow">or</span> <span class="n">c_data</span><span class="p">[</span><span class="s2">&quot;elem&quot;</span><span class="p">]</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fil_elem</span><span class="p">):</span>
                <span class="n">character_list</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">i</span><span class="p">,</span> <span class="n">game</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">get_player_character</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">c</span><span class="p">[</span><span class="s2">&quot;uuid&quot;</span><span class="p">])])</span>

        <span class="c1"># ソートを適用</span>
        <span class="n">sort_cat_name</span><span class="p">,</span> <span class="n">sort_cat_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sort_cat</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">sort_key_map</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;lv&quot;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">lv</span><span class="p">,</span>
            <span class="s2">&quot;rarity&quot;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">rarity</span><span class="p">,</span>
            <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">status</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">sort_cat_id</span><span class="p">)]</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="n">sort_cat_name</span> <span class="ow">in</span> <span class="n">sort_key_map</span><span class="p">:</span>
            <span class="n">character_list</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="n">sort_key_map</span><span class="p">[</span><span class="n">sort_cat_name</span><span class="p">],</span> <span class="n">reverse</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sort_reverse</span><span class="p">)</span>

        <span class="c1"># ページ情報を更新</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">character_list</span> <span class="o">=</span> <span class="n">character_list</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current_page</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">max_page</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">character_list</span><span class="p">)</span> <span class="o">/</span> <span class="mi">10</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>

        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">show_chara_list</span><span class="p">(</span><span class="n">interaction</span><span class="p">,</span> <span class="n">is_send</span><span class="p">)</span></div>
</div>



<div class="viewcode-block" id="WeaponInventory">
<a class="viewcode-back" href="../../../src.cog.html#src.cog.inventory.WeaponInventory">[ドキュメント]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">WeaponInventory</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;武器インベントリのUIフローと状態を管理するクラス。&quot;&quot;&quot;</span>

<div class="viewcode-block" id="WeaponInventory.ViewSelectWeapon">
<a class="viewcode-back" href="../../../src.cog.html#src.cog.inventory.WeaponInventory.ViewSelectWeapon">[ドキュメント]</a>
    <span class="k">class</span><span class="w"> </span><span class="nc">ViewSelectWeapon</span><span class="p">(</span><span class="n">discord</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">View</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;武器一覧画面で表示されるViewコンポーネント。&quot;&quot;&quot;</span>
<div class="viewcode-block" id="WeaponInventory.ViewSelectWeapon.ButtonSelectWeapon">
<a class="viewcode-back" href="../../../src.cog.html#src.cog.inventory.WeaponInventory.ViewSelectWeapon.ButtonSelectWeapon">[ドキュメント]</a>
        <span class="k">class</span><span class="w"> </span><span class="nc">ButtonSelectWeapon</span><span class="p">(</span><span class="n">discord</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">Button</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;一覧に表示される各武器に対応する選択ボタン。&quot;&quot;&quot;</span>
            <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">weapon</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">style</span><span class="p">:</span> <span class="n">discord</span><span class="o">.</span><span class="n">ButtonStyle</span> <span class="o">=</span> <span class="n">discord</span><span class="o">.</span><span class="n">ButtonStyle</span><span class="o">.</span><span class="n">secondary</span><span class="p">,</span> <span class="n">label</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">row</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
                <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="n">style</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="n">row</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">weapon</span> <span class="o">=</span> <span class="n">weapon</span>

<div class="viewcode-block" id="WeaponInventory.ViewSelectWeapon.ButtonSelectWeapon.callback">
<a class="viewcode-back" href="../../../src.cog.html#src.cog.inventory.WeaponInventory.ViewSelectWeapon.ButtonSelectWeapon.callback">[ドキュメント]</a>
            <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">callback</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">interaction</span><span class="p">:</span> <span class="n">discord</span><span class="o">.</span><span class="n">Interaction</span><span class="p">):</span>
<span class="w">                </span><span class="sd">&quot;&quot;&quot;武器選択ボタンが押された際のコールバック。&quot;&quot;&quot;</span>
                <span class="k">if</span> <span class="n">interaction</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">id</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">id</span><span class="p">:</span> <span class="k">return</span> <span class="k">await</span> <span class="n">interaction</span><span class="o">.</span><span class="n">response</span><span class="o">.</span><span class="n">defer</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">selected_weapon</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">weapon</span>
                <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">show_weapon</span><span class="p">(</span><span class="n">interaction</span><span class="p">)</span></div>
</div>


<div class="viewcode-block" id="WeaponInventory.ViewSelectWeapon.SelectFilter">
<a class="viewcode-back" href="../../../src.cog.html#src.cog.inventory.WeaponInventory.ViewSelectWeapon.SelectFilter">[ドキュメント]</a>
        <span class="k">class</span><span class="w"> </span><span class="nc">SelectFilter</span><span class="p">(</span><span class="n">discord</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">Select</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;レアリティ、対応職業、スキルで武器をフィルタリングするドロップダウンメニュー。&quot;&quot;&quot;</span>
<div class="viewcode-block" id="WeaponInventory.ViewSelectWeapon.SelectFilter.callback">
<a class="viewcode-back" href="../../../src.cog.html#src.cog.inventory.WeaponInventory.ViewSelectWeapon.SelectFilter.callback">[ドキュメント]</a>
            <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">callback</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">discord</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">Select</span><span class="p">,</span> <span class="n">interaction</span><span class="p">:</span> <span class="n">discord</span><span class="o">.</span><span class="n">Interaction</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">interaction</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">id</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">id</span><span class="p">:</span> <span class="k">return</span> <span class="k">await</span> <span class="n">interaction</span><span class="o">.</span><span class="n">response</span><span class="o">.</span><span class="n">defer</span><span class="p">()</span>
                <span class="n">fil_rarity</span><span class="p">,</span> <span class="n">fil_job</span><span class="p">,</span> <span class="n">fil_skill</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">:</span>
                    <span class="n">cat</span><span class="p">,</span> <span class="nb">id</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
                    <span class="nb">id</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">id</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">cat</span> <span class="o">==</span> <span class="s2">&quot;rarity&quot;</span><span class="p">:</span> <span class="n">fil_rarity</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">id</span><span class="p">)</span>
                    <span class="k">elif</span> <span class="n">cat</span> <span class="o">==</span> <span class="s2">&quot;job&quot;</span><span class="p">:</span> <span class="n">fil_job</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">id</span><span class="p">)</span>
                    <span class="k">elif</span> <span class="n">cat</span> <span class="o">==</span> <span class="s2">&quot;skill&quot;</span><span class="p">:</span> <span class="n">fil_skill</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">id</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">filters</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">fil_rarity</span> <span class="o">=</span> <span class="n">fil_rarity</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">fil_job</span> <span class="o">=</span> <span class="n">fil_job</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">fil_skill</span> <span class="o">=</span> <span class="n">fil_skill</span>
                <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">update_weapon_list</span><span class="p">(</span><span class="n">interaction</span><span class="p">)</span></div>
</div>


<div class="viewcode-block" id="WeaponInventory.ViewSelectWeapon.SelectSort">
<a class="viewcode-back" href="../../../src.cog.html#src.cog.inventory.WeaponInventory.ViewSelectWeapon.SelectSort">[ドキュメント]</a>
        <span class="k">class</span><span class="w"> </span><span class="nc">SelectSort</span><span class="p">(</span><span class="n">discord</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">Select</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;武器のソート基準を選択するドロップダウンメニュー。&quot;&quot;&quot;</span>
<div class="viewcode-block" id="WeaponInventory.ViewSelectWeapon.SelectSort.callback">
<a class="viewcode-back" href="../../../src.cog.html#src.cog.inventory.WeaponInventory.ViewSelectWeapon.SelectSort.callback">[ドキュメント]</a>
            <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">callback</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">interaction</span><span class="p">:</span> <span class="n">discord</span><span class="o">.</span><span class="n">Interaction</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">interaction</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">id</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">id</span><span class="p">:</span> <span class="k">return</span> <span class="k">await</span> <span class="n">interaction</span><span class="o">.</span><span class="n">response</span><span class="o">.</span><span class="n">defer</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">sort_cat</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">update_weapon_list</span><span class="p">(</span><span class="n">interaction</span><span class="p">)</span></div>
</div>

        
<div class="viewcode-block" id="WeaponInventory.ViewSelectWeapon.ButtonTopPage">
<a class="viewcode-back" href="../../../src.cog.html#src.cog.inventory.WeaponInventory.ViewSelectWeapon.ButtonTopPage">[ドキュメント]</a>
        <span class="k">class</span><span class="w"> </span><span class="nc">ButtonTopPage</span><span class="p">(</span><span class="n">discord</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">Button</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;一覧の最初のページに移動するボタン。&quot;&quot;&quot;</span>
<div class="viewcode-block" id="WeaponInventory.ViewSelectWeapon.ButtonTopPage.callback">
<a class="viewcode-back" href="../../../src.cog.html#src.cog.inventory.WeaponInventory.ViewSelectWeapon.ButtonTopPage.callback">[ドキュメント]</a>
            <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">callback</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">interaction</span><span class="p">:</span> <span class="n">discord</span><span class="o">.</span><span class="n">Interaction</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">interaction</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">id</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">id</span><span class="p">:</span>
                    <span class="k">await</span> <span class="n">interaction</span><span class="o">.</span><span class="n">response</span><span class="o">.</span><span class="n">defer</span><span class="p">()</span>
                    <span class="k">return</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">current_page</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">show_chara_list</span><span class="p">(</span><span class="n">interaction</span><span class="p">)</span></div>
</div>



<div class="viewcode-block" id="WeaponInventory.ViewSelectWeapon.ButtonPrevPage">
<a class="viewcode-back" href="../../../src.cog.html#src.cog.inventory.WeaponInventory.ViewSelectWeapon.ButtonPrevPage">[ドキュメント]</a>
        <span class="k">class</span><span class="w"> </span><span class="nc">ButtonPrevPage</span><span class="p">(</span><span class="n">discord</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">Button</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;一覧の前のページに移動するボタン。&quot;&quot;&quot;</span>
<div class="viewcode-block" id="WeaponInventory.ViewSelectWeapon.ButtonPrevPage.callback">
<a class="viewcode-back" href="../../../src.cog.html#src.cog.inventory.WeaponInventory.ViewSelectWeapon.ButtonPrevPage.callback">[ドキュメント]</a>
            <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">callback</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">interaction</span><span class="p">:</span> <span class="n">discord</span><span class="o">.</span><span class="n">Interaction</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">interaction</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">id</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">id</span><span class="p">:</span>
                    <span class="k">await</span> <span class="n">interaction</span><span class="o">.</span><span class="n">response</span><span class="o">.</span><span class="n">defer</span><span class="p">()</span>
                    <span class="k">return</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">current_page</span> <span class="o">-=</span> <span class="mi">1</span>
                <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">show_chara_list</span><span class="p">(</span><span class="n">interaction</span><span class="p">)</span></div>
</div>

            

<div class="viewcode-block" id="WeaponInventory.ViewSelectWeapon.ButtonNextPage">
<a class="viewcode-back" href="../../../src.cog.html#src.cog.inventory.WeaponInventory.ViewSelectWeapon.ButtonNextPage">[ドキュメント]</a>
        <span class="k">class</span><span class="w"> </span><span class="nc">ButtonNextPage</span><span class="p">(</span><span class="n">discord</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">Button</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;一覧の次のページに移動するボタン。&quot;&quot;&quot;</span>
<div class="viewcode-block" id="WeaponInventory.ViewSelectWeapon.ButtonNextPage.callback">
<a class="viewcode-back" href="../../../src.cog.html#src.cog.inventory.WeaponInventory.ViewSelectWeapon.ButtonNextPage.callback">[ドキュメント]</a>
            <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">callback</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">interaction</span><span class="p">:</span> <span class="n">discord</span><span class="o">.</span><span class="n">Interaction</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">interaction</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">id</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">id</span><span class="p">:</span>
                    <span class="k">await</span> <span class="n">interaction</span><span class="o">.</span><span class="n">response</span><span class="o">.</span><span class="n">defer</span><span class="p">()</span>
                    <span class="k">return</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">current_page</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">show_chara_list</span><span class="p">(</span><span class="n">interaction</span><span class="p">)</span></div>
</div>

            

<div class="viewcode-block" id="WeaponInventory.ViewSelectWeapon.ButtonReverseSort">
<a class="viewcode-back" href="../../../src.cog.html#src.cog.inventory.WeaponInventory.ViewSelectWeapon.ButtonReverseSort">[ドキュメント]</a>
        <span class="k">class</span><span class="w"> </span><span class="nc">ButtonReverseSort</span><span class="p">(</span><span class="n">discord</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">Button</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;ソート順（昇順/降順）を切り替えるボタン。&quot;&quot;&quot;</span>
<div class="viewcode-block" id="WeaponInventory.ViewSelectWeapon.ButtonReverseSort.callback">
<a class="viewcode-back" href="../../../src.cog.html#src.cog.inventory.WeaponInventory.ViewSelectWeapon.ButtonReverseSort.callback">[ドキュメント]</a>
            <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">callback</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">interaction</span><span class="p">:</span> <span class="n">discord</span><span class="o">.</span><span class="n">Interaction</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">interaction</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">id</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">id</span><span class="p">:</span>
                    <span class="k">await</span> <span class="n">interaction</span><span class="o">.</span><span class="n">response</span><span class="o">.</span><span class="n">defer</span><span class="p">()</span>
                    <span class="k">return</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">sort_reverse</span> <span class="o">=</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">sort_reverse</span>
                <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">update_chara_list</span><span class="p">(</span><span class="n">interaction</span><span class="p">)</span></div>
</div>

                

        <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">:</span> <span class="s2">&quot;WeaponInventory&quot;</span><span class="p">,</span> <span class="n">weapon_list</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">],</span> <span class="o">*</span><span class="p">,</span> <span class="n">timeout</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="mi">180</span><span class="p">):</span>
            <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">timeout</span><span class="o">=</span><span class="n">timeout</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">obj</span> <span class="o">=</span> <span class="n">obj</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">weapon_list</span><span class="p">):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">add_item</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ButtonSelectWeapon</span><span class="p">(</span><span class="n">weapon_list</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">style</span><span class="o">=</span><span class="n">discord</span><span class="o">.</span><span class="n">ButtonStyle</span><span class="o">.</span><span class="n">blurple</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">weapon_list</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">add_item</span><span class="p">(</span><span class="n">discord</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="n">discord</span><span class="o">.</span><span class="n">ButtonStyle</span><span class="o">.</span><span class="n">gray</span><span class="p">,</span> <span class="n">disabled</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
            
            <span class="bp">self</span><span class="o">.</span><span class="n">select_filter</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">SelectFilter</span><span class="p">(</span><span class="n">placeholder</span><span class="o">=</span><span class="s2">&quot;フィルター&quot;</span><span class="p">,</span> <span class="n">min_values</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">max_values</span><span class="o">=</span><span class="mi">22</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">select_filter</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;フィルターなし&quot;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="s2">&quot;blank-0&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;blank-0&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">filters</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">select_filter</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;[レア度]⭐️⭐️⭐️&quot;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="s2">&quot;rarity-0&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;rarity-0&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">filters</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">select_filter</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;[レア度]⭐️⭐️⭐️⭐️&quot;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="s2">&quot;rarity-1&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;rarity-1&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">filters</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">select_filter</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;[レア度]⭐️⭐️⭐️⭐️⭐️&quot;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="s2">&quot;rarity-2&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;rarity-2&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">filters</span><span class="p">))</span>

            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">game</span><span class="o">.</span><span class="n">Job</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">select_filter</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;[対応職業]</span><span class="si">{</span><span class="n">j</span><span class="o">.</span><span class="n">name_ja</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;job-</span><span class="si">{</span><span class="n">j</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;job-</span><span class="si">{</span><span class="n">j</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s2">&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">filters</span><span class="p">))</span>

            <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">game</span><span class="o">.</span><span class="n">Skill</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">select_filter</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;[スキル]</span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">name_ja</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;skill-</span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;skill-</span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s2">&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">filters</span><span class="p">))</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">add_item</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">select_filter</span><span class="p">)</span>


            <span class="bp">self</span><span class="o">.</span><span class="n">select_sort</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">SelectSort</span><span class="p">(</span><span class="n">placeholder</span><span class="o">=</span><span class="s2">&quot;ソート&quot;</span><span class="p">,</span> <span class="n">min_values</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">max_values</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">select_sort</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;ソート：レベル&quot;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="s2">&quot;lv-0&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;lv-0&quot;</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">sort_cat</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">select_sort</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;ソート：レア度&quot;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="s2">&quot;rarity-0&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;rarity-0&quot;</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">sort_cat</span><span class="p">))</span>

            <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">game</span><span class="o">.</span><span class="n">Status</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">s</span><span class="o">.</span><span class="n">is_weapon</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">select_sort</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;ソート：</span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">name_ja</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;status-</span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;status-</span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s2">&quot;</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">sort_cat</span><span class="p">))</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">add_item</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">select_sort</span><span class="p">)</span>
            
            <span class="bp">self</span><span class="o">.</span><span class="n">add_item</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ButtonTopPage</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;&lt;&lt;&quot;</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="n">discord</span><span class="o">.</span><span class="n">ButtonStyle</span><span class="o">.</span><span class="n">blurple</span><span class="p">,</span> <span class="n">disabled</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">current_page</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_item</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ButtonPrevPage</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;&lt;&quot;</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="n">discord</span><span class="o">.</span><span class="n">ButtonStyle</span><span class="o">.</span><span class="n">blurple</span><span class="p">,</span> <span class="n">disabled</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">current_page</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_item</span><span class="p">(</span><span class="n">discord</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">current_page</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2"> / </span><span class="si">{</span><span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">max_page</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">disabled</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="n">discord</span><span class="o">.</span><span class="n">ButtonStyle</span><span class="o">.</span><span class="n">gray</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_item</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ButtonNextPage</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;&gt;&quot;</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="n">discord</span><span class="o">.</span><span class="n">ButtonStyle</span><span class="o">.</span><span class="n">blurple</span><span class="p">,</span> <span class="n">disabled</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">current_page</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">max_page</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_item</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ButtonReverseSort</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39;ソート：昇&#39;</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">sort_reverse</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;ソート：降&#39;</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="n">discord</span><span class="o">.</span><span class="n">ButtonStyle</span><span class="o">.</span><span class="n">blurple</span><span class="p">))</span></div>


<div class="viewcode-block" id="WeaponInventory.ViewWeapon">
<a class="viewcode-back" href="../../../src.cog.html#src.cog.inventory.WeaponInventory.ViewWeapon">[ドキュメント]</a>
    <span class="k">class</span><span class="w"> </span><span class="nc">ViewWeapon</span><span class="p">(</span><span class="n">discord</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">View</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;武器詳細画面のView。「戻る」「レベルアップ」ボタンを提供。&quot;&quot;&quot;</span>
        <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">:</span> <span class="s2">&quot;WeaponInventory&quot;</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">timeout</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="mi">180</span><span class="p">):</span>
            <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">timeout</span><span class="o">=</span><span class="n">timeout</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">obj</span> <span class="o">=</span> <span class="n">obj</span>
        
<div class="viewcode-block" id="WeaponInventory.ViewWeapon.ButtonBack">
<a class="viewcode-back" href="../../../src.cog.html#src.cog.inventory.WeaponInventory.ViewWeapon.ButtonBack">[ドキュメント]</a>
        <span class="nd">@discord</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">button</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;Back&quot;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="n">discord</span><span class="o">.</span><span class="n">ButtonStyle</span><span class="o">.</span><span class="n">gray</span><span class="p">)</span>
        <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">ButtonBack</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">int</span><span class="p">:</span> <span class="n">discord</span><span class="o">.</span><span class="n">Interaction</span><span class="p">,</span> <span class="n">button</span><span class="p">:</span> <span class="n">discord</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">Button</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">int</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">id</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">id</span><span class="p">:</span> <span class="k">await</span> <span class="nb">int</span><span class="o">.</span><span class="n">response</span><span class="o">.</span><span class="n">defer</span><span class="p">();</span> <span class="k">return</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">selected_weapon</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">show_weapon_list</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span></div>

        
<div class="viewcode-block" id="WeaponInventory.ViewWeapon.ButtonLvUp">
<a class="viewcode-back" href="../../../src.cog.html#src.cog.inventory.WeaponInventory.ViewWeapon.ButtonLvUp">[ドキュメント]</a>
        <span class="nd">@discord</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">button</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;Level Up&quot;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="n">discord</span><span class="o">.</span><span class="n">ButtonStyle</span><span class="o">.</span><span class="n">blurple</span><span class="p">)</span>
        <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">ButtonLvUp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">int</span><span class="p">:</span> <span class="n">discord</span><span class="o">.</span><span class="n">Interaction</span><span class="p">,</span> <span class="n">button</span><span class="p">:</span> <span class="n">discord</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">Button</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">int</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">id</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">id</span><span class="p">:</span> <span class="k">await</span> <span class="nb">int</span><span class="o">.</span><span class="n">response</span><span class="o">.</span><span class="n">defer</span><span class="p">();</span> <span class="k">return</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">exp_item_count</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">show_lvup_weapon</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span></div>
</div>


<div class="viewcode-block" id="WeaponInventory.ViewLvUpWeapon">
<a class="viewcode-back" href="../../../src.cog.html#src.cog.inventory.WeaponInventory.ViewLvUpWeapon">[ドキュメント]</a>
    <span class="k">class</span><span class="w"> </span><span class="nc">ViewLvUpWeapon</span><span class="p">(</span><span class="n">discord</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">View</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;武器レベルアップ画面のView。&quot;&quot;&quot;</span>
<div class="viewcode-block" id="WeaponInventory.ViewLvUpWeapon.ModalInputCount">
<a class="viewcode-back" href="../../../src.cog.html#src.cog.inventory.WeaponInventory.ViewLvUpWeapon.ModalInputCount">[ドキュメント]</a>
        <span class="k">class</span><span class="w"> </span><span class="nc">ModalInputCount</span><span class="p">(</span><span class="n">discord</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">Modal</span><span class="p">):</span>
            <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">:</span> <span class="s2">&quot;WeaponInventory&quot;</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
                <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">obj</span> <span class="o">=</span> <span class="n">obj</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">count</span> <span class="o">=</span> <span class="n">discord</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">TextInput</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;使用する</span><span class="si">{</span><span class="n">game</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">get_item_data_by_id</span><span class="p">(</span><span class="mi">1</span><span class="p">)[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1">の数&#39;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="n">discord</span><span class="o">.</span><span class="n">TextStyle</span><span class="o">.</span><span class="n">short</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">add_item</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">count</span><span class="p">)</span>
<div class="viewcode-block" id="WeaponInventory.ViewLvUpWeapon.ModalInputCount.on_submit">
<a class="viewcode-back" href="../../../src.cog.html#src.cog.inventory.WeaponInventory.ViewLvUpWeapon.ModalInputCount.on_submit">[ドキュメント]</a>
            <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">on_submit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">interaction</span><span class="p">:</span> <span class="n">discord</span><span class="o">.</span><span class="n">Interaction</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">exp_item_count</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">calc_lvup</span><span class="p">(</span><span class="n">interaction</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">count</span><span class="o">.</span><span class="n">value</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">count</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">isdecimal</span><span class="p">()</span> <span class="k">else</span> <span class="mi">0</span><span class="p">)</span></div>
</div>


        <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">:</span> <span class="s2">&quot;WeaponInventory&quot;</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">timeout</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="mi">180</span><span class="p">):</span>
            <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">timeout</span><span class="o">=</span><span class="n">timeout</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">obj</span> <span class="o">=</span> <span class="n">obj</span>
        
<div class="viewcode-block" id="WeaponInventory.ViewLvUpWeapon.ButtonSub10">
<a class="viewcode-back" href="../../../src.cog.html#src.cog.inventory.WeaponInventory.ViewLvUpWeapon.ButtonSub10">[ドキュメント]</a>
        <span class="nd">@discord</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">button</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;-10&quot;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="n">discord</span><span class="o">.</span><span class="n">ButtonStyle</span><span class="o">.</span><span class="n">blurple</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">ButtonSub10</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">int</span><span class="p">:</span> <span class="n">discord</span><span class="o">.</span><span class="n">Interaction</span><span class="p">,</span> <span class="n">button</span><span class="p">:</span> <span class="n">discord</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">Button</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">int</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">id</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">id</span><span class="p">:</span> <span class="k">await</span> <span class="nb">int</span><span class="o">.</span><span class="n">response</span><span class="o">.</span><span class="n">defer</span><span class="p">();</span> <span class="k">return</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">calc_lvup</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="o">-</span><span class="mi">10</span><span class="p">)</span></div>

<div class="viewcode-block" id="WeaponInventory.ViewLvUpWeapon.ButtonSub1">
<a class="viewcode-back" href="../../../src.cog.html#src.cog.inventory.WeaponInventory.ViewLvUpWeapon.ButtonSub1">[ドキュメント]</a>
        <span class="nd">@discord</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">button</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;-1&quot;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="n">discord</span><span class="o">.</span><span class="n">ButtonStyle</span><span class="o">.</span><span class="n">blurple</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">ButtonSub1</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">int</span><span class="p">:</span> <span class="n">discord</span><span class="o">.</span><span class="n">Interaction</span><span class="p">,</span> <span class="n">button</span><span class="p">:</span> <span class="n">discord</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">Button</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">int</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">id</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">id</span><span class="p">:</span> <span class="k">await</span> <span class="nb">int</span><span class="o">.</span><span class="n">response</span><span class="o">.</span><span class="n">defer</span><span class="p">();</span> <span class="k">return</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">calc_lvup</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span></div>

<div class="viewcode-block" id="WeaponInventory.ViewLvUpWeapon.ButtonInput">
<a class="viewcode-back" href="../../../src.cog.html#src.cog.inventory.WeaponInventory.ViewLvUpWeapon.ButtonInput">[ドキュメント]</a>
        <span class="nd">@discord</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">button</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;入力&quot;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="n">discord</span><span class="o">.</span><span class="n">ButtonStyle</span><span class="o">.</span><span class="n">blurple</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">ButtonInput</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">int</span><span class="p">:</span> <span class="n">discord</span><span class="o">.</span><span class="n">Interaction</span><span class="p">,</span> <span class="n">button</span><span class="p">:</span> <span class="n">discord</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">Button</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">int</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">id</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">id</span><span class="p">:</span> <span class="k">await</span> <span class="nb">int</span><span class="o">.</span><span class="n">response</span><span class="o">.</span><span class="n">defer</span><span class="p">();</span> <span class="k">return</span>
            <span class="k">await</span> <span class="nb">int</span><span class="o">.</span><span class="n">response</span><span class="o">.</span><span class="n">send_modal</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ModalInputCount</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;入力&quot;</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">180</span><span class="p">))</span></div>

<div class="viewcode-block" id="WeaponInventory.ViewLvUpWeapon.ButtonAdd1">
<a class="viewcode-back" href="../../../src.cog.html#src.cog.inventory.WeaponInventory.ViewLvUpWeapon.ButtonAdd1">[ドキュメント]</a>
        <span class="nd">@discord</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">button</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;+1&quot;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="n">discord</span><span class="o">.</span><span class="n">ButtonStyle</span><span class="o">.</span><span class="n">blurple</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">ButtonAdd1</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">int</span><span class="p">:</span> <span class="n">discord</span><span class="o">.</span><span class="n">Interaction</span><span class="p">,</span> <span class="n">button</span><span class="p">:</span> <span class="n">discord</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">Button</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">int</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">id</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">id</span><span class="p">:</span> <span class="k">await</span> <span class="nb">int</span><span class="o">.</span><span class="n">response</span><span class="o">.</span><span class="n">defer</span><span class="p">();</span> <span class="k">return</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">calc_lvup</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span></div>

<div class="viewcode-block" id="WeaponInventory.ViewLvUpWeapon.ButtonAdd10">
<a class="viewcode-back" href="../../../src.cog.html#src.cog.inventory.WeaponInventory.ViewLvUpWeapon.ButtonAdd10">[ドキュメント]</a>
        <span class="nd">@discord</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">button</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;+10&quot;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="n">discord</span><span class="o">.</span><span class="n">ButtonStyle</span><span class="o">.</span><span class="n">blurple</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">ButtonAdd10</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">int</span><span class="p">:</span> <span class="n">discord</span><span class="o">.</span><span class="n">Interaction</span><span class="p">,</span> <span class="n">button</span><span class="p">:</span> <span class="n">discord</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">Button</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">int</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">id</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">id</span><span class="p">:</span> <span class="k">await</span> <span class="nb">int</span><span class="o">.</span><span class="n">response</span><span class="o">.</span><span class="n">defer</span><span class="p">();</span> <span class="k">return</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">calc_lvup</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span></div>

<div class="viewcode-block" id="WeaponInventory.ViewLvUpWeapon.ButtonSub100">
<a class="viewcode-back" href="../../../src.cog.html#src.cog.inventory.WeaponInventory.ViewLvUpWeapon.ButtonSub100">[ドキュメント]</a>
        <span class="nd">@discord</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">button</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;-100&quot;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="n">discord</span><span class="o">.</span><span class="n">ButtonStyle</span><span class="o">.</span><span class="n">blurple</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">ButtonSub100</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">int</span><span class="p">:</span> <span class="n">discord</span><span class="o">.</span><span class="n">Interaction</span><span class="p">,</span> <span class="n">button</span><span class="p">:</span> <span class="n">discord</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">Button</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">int</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">id</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">id</span><span class="p">:</span> <span class="k">await</span> <span class="nb">int</span><span class="o">.</span><span class="n">response</span><span class="o">.</span><span class="n">defer</span><span class="p">();</span> <span class="k">return</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">calc_lvup</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="o">-</span><span class="mi">100</span><span class="p">)</span></div>

<div class="viewcode-block" id="WeaponInventory.ViewLvUpWeapon.ButtonSubmit">
<a class="viewcode-back" href="../../../src.cog.html#src.cog.inventory.WeaponInventory.ViewLvUpWeapon.ButtonSubmit">[ドキュメント]</a>
        <span class="nd">@discord</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">button</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;確定&quot;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="n">discord</span><span class="o">.</span><span class="n">ButtonStyle</span><span class="o">.</span><span class="n">green</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">ButtonSubmit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">int</span><span class="p">:</span> <span class="n">discord</span><span class="o">.</span><span class="n">Interaction</span><span class="p">,</span> <span class="n">button</span><span class="p">:</span> <span class="n">discord</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">Button</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">int</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">id</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">id</span><span class="p">:</span> <span class="k">await</span> <span class="nb">int</span><span class="o">.</span><span class="n">response</span><span class="o">.</span><span class="n">defer</span><span class="p">();</span> <span class="k">return</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">lvup_weapon</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span></div>

<div class="viewcode-block" id="WeaponInventory.ViewLvUpWeapon.ButtonAdd100">
<a class="viewcode-back" href="../../../src.cog.html#src.cog.inventory.WeaponInventory.ViewLvUpWeapon.ButtonAdd100">[ドキュメント]</a>
        <span class="nd">@discord</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">button</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;+100&quot;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="n">discord</span><span class="o">.</span><span class="n">ButtonStyle</span><span class="o">.</span><span class="n">blurple</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">ButtonAdd100</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">int</span><span class="p">:</span> <span class="n">discord</span><span class="o">.</span><span class="n">Interaction</span><span class="p">,</span> <span class="n">button</span><span class="p">:</span> <span class="n">discord</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">Button</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">int</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">id</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">id</span><span class="p">:</span> <span class="k">await</span> <span class="nb">int</span><span class="o">.</span><span class="n">response</span><span class="o">.</span><span class="n">defer</span><span class="p">();</span> <span class="k">return</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">calc_lvup</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span></div>
</div>


    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;WeaponInventoryセッションを初期化します。&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">user</span><span class="p">:</span> <span class="n">discord</span><span class="o">.</span><span class="n">User</span> <span class="o">|</span> <span class="n">discord</span><span class="o">.</span><span class="n">Member</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">weapon_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current_page</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">max_page</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">filters</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fil_rarity</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fil_job</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fil_skill</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sort_cat</span> <span class="o">=</span> <span class="s2">&quot;lv-0&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sort_reverse</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">selected_weapon</span><span class="p">:</span> <span class="nb">list</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">exp_item_count</span> <span class="o">=</span> <span class="mi">0</span>

<div class="viewcode-block" id="WeaponInventory.show_lvup_weapon">
<a class="viewcode-back" href="../../../src.cog.html#src.cog.inventory.WeaponInventory.show_lvup_weapon">[ドキュメント]</a>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">show_lvup_weapon</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">int</span><span class="p">:</span> <span class="n">discord</span><span class="o">.</span><span class="n">Interaction</span><span class="p">,</span> <span class="n">lvup_count</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;武器レベルアップ画面を表示します。&quot;&quot;&quot;</span>
        <span class="n">index</span><span class="p">,</span> <span class="n">weapon</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">selected_weapon</span>
        <span class="n">embed</span> <span class="o">=</span> <span class="n">discord</span><span class="o">.</span><span class="n">Embed</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;[レベルアップ] </span><span class="si">{</span><span class="n">index</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s1">. </span><span class="si">{</span><span class="n">weapon</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;使用する</span><span class="si">{</span><span class="n">game</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">get_item_data_by_id</span><span class="p">(</span><span class="mi">1</span><span class="p">)[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1">の数：**</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">exp_item_count</span><span class="si">}</span><span class="s1">** / </span><span class="si">{</span><span class="n">game</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">get_player_item_count</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">discord</span><span class="o">.</span><span class="n">Colour</span><span class="o">.</span><span class="n">from_rgb</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">))</span>
        <span class="n">embed</span><span class="o">.</span><span class="n">add_field</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;レベル&quot;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">weapon</span><span class="o">.</span><span class="n">lv</span><span class="si">}</span><span class="s1"> &gt;&gt; </span><span class="si">{</span><span class="n">weapon</span><span class="o">.</span><span class="n">lv</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">lvup_count</span><span class="si">}</span><span class="s1"> / </span><span class="si">{</span><span class="n">game</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">get_player_level</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">id</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">view</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ViewLvUpWeapon</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">await</span> <span class="nb">int</span><span class="o">.</span><span class="n">response</span><span class="o">.</span><span class="n">edit_message</span><span class="p">(</span><span class="n">embed</span><span class="o">=</span><span class="n">embed</span><span class="p">,</span> <span class="n">attachments</span><span class="o">=</span><span class="p">[],</span> <span class="n">view</span><span class="o">=</span><span class="n">view</span><span class="p">)</span></div>


<div class="viewcode-block" id="WeaponInventory.calc_lvup">
<a class="viewcode-back" href="../../../src.cog.html#src.cog.inventory.WeaponInventory.calc_lvup">[ドキュメント]</a>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">calc_lvup</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">interaction</span><span class="p">:</span> <span class="n">discord</span><span class="o">.</span><span class="n">Interaction</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;レベルアップに使用するアイテム数を計算し、画面を更新します。&quot;&quot;&quot;</span>
        <span class="n">index</span><span class="p">,</span> <span class="n">weapon</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">selected_weapon</span>
        <span class="n">lvup_count</span><span class="p">,</span> <span class="n">exp_item_count</span> <span class="o">=</span> <span class="n">game</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">calc_weapon_lvup</span><span class="p">(</span><span class="n">weapon</span><span class="o">.</span><span class="n">lv</span><span class="p">,</span> <span class="n">weapon</span><span class="o">.</span><span class="n">exp</span><span class="p">,</span> <span class="n">game</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">get_player_level</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">id</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">exp_item_count</span> <span class="o">+</span> <span class="n">value</span><span class="p">,</span> <span class="n">game</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">get_player_item_count</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="mi">1</span><span class="p">)),</span> <span class="mi">0</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">exp_item_count</span> <span class="o">=</span> <span class="n">exp_item_count</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">show_lvup_weapon</span><span class="p">(</span><span class="n">interaction</span><span class="p">,</span> <span class="n">lvup_count</span><span class="p">)</span></div>


<div class="viewcode-block" id="WeaponInventory.lvup_weapon">
<a class="viewcode-back" href="../../../src.cog.html#src.cog.inventory.WeaponInventory.lvup_weapon">[ドキュメント]</a>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">lvup_weapon</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">int</span><span class="p">:</span> <span class="n">discord</span><span class="o">.</span><span class="n">Interaction</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;武器のレベルアップを確定させます。&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">game</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">give_item</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">exp_item_count</span><span class="p">):</span>
            <span class="k">return</span> <span class="k">await</span> <span class="nb">int</span><span class="o">.</span><span class="n">response</span><span class="o">.</span><span class="n">send_message</span><span class="p">(</span><span class="s2">&quot;アイテムが足りません&quot;</span><span class="p">,</span> <span class="n">ephemeral</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">index</span><span class="p">,</span> <span class="n">weapon</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">selected_weapon</span>
        <span class="n">game</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">give_weapon_exp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">weapon</span><span class="o">.</span><span class="n">uuid</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">exp_item_count</span> <span class="o">*</span> <span class="mi">100</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">selected_weapon</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">game</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">get_player_weapon</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">weapon</span><span class="o">.</span><span class="n">uuid</span><span class="p">)</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">show_weapon</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span></div>


<div class="viewcode-block" id="WeaponInventory.show_weapon">
<a class="viewcode-back" href="../../../src.cog.html#src.cog.inventory.WeaponInventory.show_weapon">[ドキュメント]</a>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">show_weapon</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">int</span><span class="p">:</span> <span class="n">discord</span><span class="o">.</span><span class="n">Interaction</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;選択された武器の詳細を表示します。&quot;&quot;&quot;</span>
        <span class="n">index</span><span class="p">,</span> <span class="n">weapon</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">selected_weapon</span>
        <span class="n">rarity_map</span> <span class="o">=</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;⭐️⭐️⭐️&quot;</span><span class="p">,</span> <span class="n">discord</span><span class="o">.</span><span class="n">Colour</span><span class="o">.</span><span class="n">from_rgb</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">127</span><span class="p">)),</span> <span class="mi">1</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;⭐️⭐️⭐️⭐️&quot;</span><span class="p">,</span> <span class="n">discord</span><span class="o">.</span><span class="n">Colour</span><span class="o">.</span><span class="n">from_rgb</span><span class="p">(</span><span class="mi">127</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">)),</span> <span class="mi">2</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;⭐️⭐️⭐️⭐️⭐️&quot;</span><span class="p">,</span> <span class="n">discord</span><span class="o">.</span><span class="n">Colour</span><span class="o">.</span><span class="n">from_rgb</span><span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">0</span><span class="p">))}</span>
        <span class="n">rarity_desc</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="n">rarity_map</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">weapon</span><span class="o">.</span><span class="n">rarity</span><span class="p">,</span> <span class="p">(</span><span class="s2">&quot;レア度なし&quot;</span><span class="p">,</span> <span class="n">discord</span><span class="o">.</span><span class="n">Colour</span><span class="o">.</span><span class="n">from_rgb</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)))</span>
        <span class="n">embed</span> <span class="o">=</span> <span class="n">discord</span><span class="o">.</span><span class="n">Embed</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">index</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s1">. </span><span class="si">{</span><span class="n">weapon</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="n">rarity_desc</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>
        <span class="n">embed</span><span class="o">.</span><span class="n">add_field</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;レベル&quot;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">weapon</span><span class="o">.</span><span class="n">lv</span><span class="si">}</span><span class="s1"> / </span><span class="si">{</span><span class="n">game</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">get_player_level</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">id</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">embed</span><span class="o">.</span><span class="n">add_field</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;ステータス&quot;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">game</span><span class="o">.</span><span class="n">Status</span><span class="o">.</span><span class="n">HP</span><span class="o">.</span><span class="n">name_ja</span><span class="si">}</span><span class="s1">：</span><span class="si">{</span><span class="n">game</span><span class="o">.</span><span class="n">Status</span><span class="o">.</span><span class="n">HP</span><span class="o">.</span><span class="n">get_display_value</span><span class="p">(</span><span class="n">weapon</span><span class="o">.</span><span class="n">status</span><span class="p">[</span><span class="n">game</span><span class="o">.</span><span class="n">Status</span><span class="o">.</span><span class="n">HP</span><span class="o">.</span><span class="n">id</span><span class="p">])</span><span class="si">}</span><span class="se">\n</span><span class="si">{</span><span class="n">game</span><span class="o">.</span><span class="n">Status</span><span class="o">.</span><span class="n">ATK</span><span class="o">.</span><span class="n">name_ja</span><span class="si">}</span><span class="s1">：</span><span class="si">{</span><span class="n">game</span><span class="o">.</span><span class="n">Status</span><span class="o">.</span><span class="n">ATK</span><span class="o">.</span><span class="n">get_display_value</span><span class="p">(</span><span class="n">weapon</span><span class="o">.</span><span class="n">status</span><span class="p">[</span><span class="n">game</span><span class="o">.</span><span class="n">Status</span><span class="o">.</span><span class="n">ATK</span><span class="o">.</span><span class="n">id</span><span class="p">])</span><span class="si">}</span><span class="se">\n</span><span class="si">{</span><span class="n">game</span><span class="o">.</span><span class="n">Status</span><span class="o">.</span><span class="n">DEF</span><span class="o">.</span><span class="n">name_ja</span><span class="si">}</span><span class="s1">：</span><span class="si">{</span><span class="n">game</span><span class="o">.</span><span class="n">Status</span><span class="o">.</span><span class="n">DEF</span><span class="o">.</span><span class="n">get_display_value</span><span class="p">(</span><span class="n">weapon</span><span class="o">.</span><span class="n">status</span><span class="p">[</span><span class="n">game</span><span class="o">.</span><span class="n">Status</span><span class="o">.</span><span class="n">DEF</span><span class="o">.</span><span class="n">id</span><span class="p">])</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">embed</span><span class="o">.</span><span class="n">add_field</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;対応職業&quot;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">weapon</span><span class="o">.</span><span class="n">job</span><span class="o">.</span><span class="n">name_ja</span><span class="p">)</span>
        <span class="n">embed</span><span class="o">.</span><span class="n">add_field</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;スキル&quot;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">weapon</span><span class="o">.</span><span class="n">skill</span><span class="o">.</span><span class="n">name_ja</span><span class="p">)</span>
        <span class="n">weapon_data</span> <span class="o">=</span> <span class="n">game</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">get_weapon_data_by_id</span><span class="p">(</span><span class="n">weapon</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
        <span class="n">file</span> <span class="o">=</span> <span class="n">discord</span><span class="o">.</span><span class="n">File</span><span class="p">(</span><span class="n">fp</span><span class="o">=</span><span class="n">utils</span><span class="o">.</span><span class="n">sys</span><span class="o">.</span><span class="n">get_game_path</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;asset/img/</span><span class="si">{</span><span class="n">weapon_data</span><span class="p">[</span><span class="s2">&quot;img_path&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">),</span><span class="n">filename</span><span class="o">=</span><span class="s2">&quot;weapon.png&quot;</span><span class="p">)</span>
        <span class="n">embed</span><span class="o">.</span><span class="n">set_image</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="s2">&quot;attachment://weapon.png&quot;</span><span class="p">)</span>
        <span class="n">view</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ViewWeapon</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">await</span> <span class="nb">int</span><span class="o">.</span><span class="n">response</span><span class="o">.</span><span class="n">edit_message</span><span class="p">(</span><span class="n">embed</span><span class="o">=</span><span class="n">embed</span><span class="p">,</span> <span class="n">attachments</span><span class="o">=</span><span class="p">[</span><span class="n">file</span><span class="p">],</span> <span class="n">view</span><span class="o">=</span><span class="n">view</span><span class="p">)</span></div>


<div class="viewcode-block" id="WeaponInventory.show_weapon_list">
<a class="viewcode-back" href="../../../src.cog.html#src.cog.inventory.WeaponInventory.show_weapon_list">[ドキュメント]</a>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">show_weapon_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">interaction</span><span class="p">:</span> <span class="n">discord</span><span class="o">.</span><span class="n">Interaction</span><span class="p">,</span> <span class="n">is_send</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;武器一覧の指定ページを表示します。&quot;&quot;&quot;</span>
        <span class="n">weapon_list_page</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">weapon_list</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">current_page</span> <span class="o">*</span> <span class="mi">10</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_page</span> <span class="o">*</span> <span class="mi">10</span> <span class="o">+</span> <span class="mi">10</span><span class="p">]</span>
        <span class="n">description</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="sa">f</span><span class="s1">&#39;**</span><span class="si">{</span><span class="n">w</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s1">.** </span><span class="si">{</span><span class="n">w</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s1"> lv.</span><span class="si">{</span><span class="n">w</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">lv</span><span class="si">}</span><span class="se">\\</span><span class="s1">n&#39;</span> <span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">weapon_list_page</span><span class="p">])</span>
        <span class="n">embed</span> <span class="o">=</span> <span class="n">discord</span><span class="o">.</span><span class="n">Embed</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;所持武器一覧&quot;</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="n">description</span><span class="o">.</span><span class="n">rstrip</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">n&quot;</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="n">discord</span><span class="o">.</span><span class="n">Colour</span><span class="o">.</span><span class="n">from_rgb</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">))</span>
        <span class="n">view</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ViewSelectWeapon</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">weapon_list_page</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">is_send</span><span class="p">:</span>
            <span class="k">await</span> <span class="n">interaction</span><span class="o">.</span><span class="n">response</span><span class="o">.</span><span class="n">send_message</span><span class="p">(</span><span class="n">embed</span><span class="o">=</span><span class="n">embed</span><span class="p">,</span> <span class="n">view</span><span class="o">=</span><span class="n">view</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">await</span> <span class="n">interaction</span><span class="o">.</span><span class="n">response</span><span class="o">.</span><span class="n">edit_message</span><span class="p">(</span><span class="n">embed</span><span class="o">=</span><span class="n">embed</span><span class="p">,</span> <span class="n">attachments</span><span class="o">=</span><span class="p">[],</span> <span class="n">view</span><span class="o">=</span><span class="n">view</span><span class="p">)</span></div>


<div class="viewcode-block" id="WeaponInventory.update_weapon_list">
<a class="viewcode-back" href="../../../src.cog.html#src.cog.inventory.WeaponInventory.update_weapon_list">[ドキュメント]</a>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">update_weapon_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">interaction</span><span class="p">:</span> <span class="n">discord</span><span class="o">.</span><span class="n">Interaction</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;フィルターとソートを適用して武器一覧を再生成・表示します。&quot;&quot;&quot;</span>
        <span class="n">is_send</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">user</span> <span class="ow">is</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">is_send</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">user</span> <span class="o">=</span> <span class="n">interaction</span><span class="o">.</span><span class="n">user</span>
        
        <span class="n">all_weapons_data</span> <span class="o">=</span> <span class="n">game</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">get_player_all_weapons_data</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
        <span class="n">weapon_list</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">w</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">all_weapons_data</span><span class="p">):</span>
            <span class="n">w_data</span> <span class="o">=</span> <span class="n">game</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">get_weapon_data_by_id</span><span class="p">(</span><span class="n">w</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">])</span>
            <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">fil_rarity</span> <span class="ow">or</span> <span class="n">w_data</span><span class="p">[</span><span class="s2">&quot;rarity&quot;</span><span class="p">]</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fil_rarity</span><span class="p">)</span> <span class="ow">and</span> \
               <span class="p">(</span><span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">fil_job</span> <span class="ow">or</span> <span class="n">w_data</span><span class="p">[</span><span class="s2">&quot;job&quot;</span><span class="p">]</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fil_job</span><span class="p">)</span> <span class="ow">and</span> \
               <span class="p">(</span><span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">fil_skill</span> <span class="ow">or</span> <span class="n">w_data</span><span class="p">[</span><span class="s2">&quot;skill&quot;</span><span class="p">]</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fil_skill</span><span class="p">):</span>
                <span class="n">weapon_list</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">i</span><span class="p">,</span> <span class="n">game</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">get_player_weapon</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">w</span><span class="p">[</span><span class="s2">&quot;uuid&quot;</span><span class="p">])])</span>

        <span class="n">sort_cat_name</span><span class="p">,</span> <span class="n">sort_cat_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sort_cat</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">sort_key_map</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;lv&quot;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">lv</span><span class="p">,</span> <span class="s2">&quot;rarity&quot;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">rarity</span><span class="p">,</span> <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">status</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">sort_cat_id</span><span class="p">)]}</span>
        <span class="k">if</span> <span class="n">sort_cat_name</span> <span class="ow">in</span> <span class="n">sort_key_map</span><span class="p">:</span>
            <span class="n">weapon_list</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="n">sort_key_map</span><span class="p">[</span><span class="n">sort_cat_name</span><span class="p">],</span> <span class="n">reverse</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sort_reverse</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">weapon_list</span> <span class="o">=</span> <span class="n">weapon_list</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current_page</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">max_page</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">weapon_list</span><span class="p">)</span> <span class="o">/</span> <span class="mi">10</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">show_weapon_list</span><span class="p">(</span><span class="n">interaction</span><span class="p">,</span> <span class="n">is_send</span><span class="p">)</span></div>
</div>



<div class="viewcode-block" id="StoneInventory">
<a class="viewcode-back" href="../../../src.cog.html#src.cog.inventory.StoneInventory">[ドキュメント]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">StoneInventory</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    ストーンインベントリのUIフローと状態を管理するクラス。</span>
<span class="sd">    ロック・粉砕機能など、ストーン固有の操作も提供します。</span>
<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="StoneInventory.ViewSelectStone">
<a class="viewcode-back" href="../../../src.cog.html#src.cog.inventory.StoneInventory.ViewSelectStone">[ドキュメント]</a>
    <span class="k">class</span><span class="w"> </span><span class="nc">ViewSelectStone</span><span class="p">(</span><span class="n">discord</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">View</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;ストーン一覧画面で表示されるViewコンポーネント。&quot;&quot;&quot;</span>
<div class="viewcode-block" id="StoneInventory.ViewSelectStone.ButtonSelectStone">
<a class="viewcode-back" href="../../../src.cog.html#src.cog.inventory.StoneInventory.ViewSelectStone.ButtonSelectStone">[ドキュメント]</a>
        <span class="k">class</span><span class="w"> </span><span class="nc">ButtonSelectStone</span><span class="p">(</span><span class="n">discord</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">Button</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;一覧に表示される各ストーンに対応する選択ボタン。&quot;&quot;&quot;</span>
            <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">stone</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">style</span><span class="p">:</span> <span class="n">discord</span><span class="o">.</span><span class="n">ButtonStyle</span> <span class="o">=</span> <span class="n">discord</span><span class="o">.</span><span class="n">ButtonStyle</span><span class="o">.</span><span class="n">secondary</span><span class="p">,</span> <span class="n">label</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
                <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="n">style</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">stone</span> <span class="o">=</span> <span class="n">stone</span>

<div class="viewcode-block" id="StoneInventory.ViewSelectStone.ButtonSelectStone.callback">
<a class="viewcode-back" href="../../../src.cog.html#src.cog.inventory.StoneInventory.ViewSelectStone.ButtonSelectStone.callback">[ドキュメント]</a>
            <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">callback</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">interaction</span><span class="p">:</span> <span class="n">discord</span><span class="o">.</span><span class="n">Interaction</span><span class="p">):</span>
<span class="w">                </span><span class="sd">&quot;&quot;&quot;ストーン選択ボタンが押された際のコールバック。&quot;&quot;&quot;</span>
                <span class="k">if</span> <span class="n">interaction</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">id</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">id</span><span class="p">:</span> <span class="k">return</span> <span class="k">await</span> <span class="n">interaction</span><span class="o">.</span><span class="n">response</span><span class="o">.</span><span class="n">defer</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">selected_stone</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">stone</span>
                <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">show_stone</span><span class="p">(</span><span class="n">interaction</span><span class="p">)</span></div>
</div>


<div class="viewcode-block" id="StoneInventory.ViewSelectStone.SelectFilter">
<a class="viewcode-back" href="../../../src.cog.html#src.cog.inventory.StoneInventory.ViewSelectStone.SelectFilter">[ドキュメント]</a>
        <span class="k">class</span><span class="w"> </span><span class="nc">SelectFilter</span><span class="p">(</span><span class="n">discord</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">Select</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;部位とセット効果でストーンをフィルタリングするドロップダウンメニュー。&quot;&quot;&quot;</span>
<div class="viewcode-block" id="StoneInventory.ViewSelectStone.SelectFilter.callback">
<a class="viewcode-back" href="../../../src.cog.html#src.cog.inventory.StoneInventory.ViewSelectStone.SelectFilter.callback">[ドキュメント]</a>
            <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">callback</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">discord</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">Select</span><span class="p">,</span> <span class="n">interaction</span><span class="p">:</span> <span class="n">discord</span><span class="o">.</span><span class="n">Interaction</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">interaction</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">id</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">id</span><span class="p">:</span> <span class="k">return</span> <span class="k">await</span> <span class="n">interaction</span><span class="o">.</span><span class="n">response</span><span class="o">.</span><span class="n">defer</span><span class="p">()</span>
                <span class="n">fil_type</span><span class="p">,</span> <span class="n">fil_set</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">:</span>
                    <span class="n">cat</span><span class="p">,</span> <span class="n">id_str</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
                    <span class="nb">id</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">id_str</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">cat</span> <span class="o">==</span> <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="n">fil_type</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">id</span><span class="p">)</span>
                    <span class="k">elif</span> <span class="n">cat</span> <span class="o">==</span> <span class="s2">&quot;set&quot;</span><span class="p">:</span> <span class="n">fil_set</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">id</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">filters</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">fil_type</span> <span class="o">=</span> <span class="n">fil_type</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">fil_set</span> <span class="o">=</span> <span class="n">fil_set</span>
                <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">update_stone_list</span><span class="p">(</span><span class="n">interaction</span><span class="p">)</span></div>
</div>


<div class="viewcode-block" id="StoneInventory.ViewSelectStone.ButtonTopPage">
<a class="viewcode-back" href="../../../src.cog.html#src.cog.inventory.StoneInventory.ViewSelectStone.ButtonTopPage">[ドキュメント]</a>
        <span class="k">class</span><span class="w"> </span><span class="nc">ButtonTopPage</span><span class="p">(</span><span class="n">discord</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">Button</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;一覧の最初のページに移動するボタン。&quot;&quot;&quot;</span>
<div class="viewcode-block" id="StoneInventory.ViewSelectStone.ButtonTopPage.callback">
<a class="viewcode-back" href="../../../src.cog.html#src.cog.inventory.StoneInventory.ViewSelectStone.ButtonTopPage.callback">[ドキュメント]</a>
            <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">callback</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">interaction</span><span class="p">:</span> <span class="n">discord</span><span class="o">.</span><span class="n">Interaction</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">interaction</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">id</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">id</span><span class="p">:</span> <span class="k">return</span> <span class="k">await</span> <span class="n">interaction</span><span class="o">.</span><span class="n">response</span><span class="o">.</span><span class="n">defer</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">current_page</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">show_stone_list</span><span class="p">(</span><span class="n">interaction</span><span class="p">)</span></div>
</div>


<div class="viewcode-block" id="StoneInventory.ViewSelectStone.ButtonPrevPage">
<a class="viewcode-back" href="../../../src.cog.html#src.cog.inventory.StoneInventory.ViewSelectStone.ButtonPrevPage">[ドキュメント]</a>
        <span class="k">class</span><span class="w"> </span><span class="nc">ButtonPrevPage</span><span class="p">(</span><span class="n">discord</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">Button</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;一覧の前のページに移動するボタン。&quot;&quot;&quot;</span>
<div class="viewcode-block" id="StoneInventory.ViewSelectStone.ButtonPrevPage.callback">
<a class="viewcode-back" href="../../../src.cog.html#src.cog.inventory.StoneInventory.ViewSelectStone.ButtonPrevPage.callback">[ドキュメント]</a>
            <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">callback</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">interaction</span><span class="p">:</span> <span class="n">discord</span><span class="o">.</span><span class="n">Interaction</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">interaction</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">id</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">id</span><span class="p">:</span> <span class="k">return</span> <span class="k">await</span> <span class="n">interaction</span><span class="o">.</span><span class="n">response</span><span class="o">.</span><span class="n">defer</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">current_page</span> <span class="o">-=</span> <span class="mi">1</span>
                <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">show_stone_list</span><span class="p">(</span><span class="n">interaction</span><span class="p">)</span></div>
</div>


<div class="viewcode-block" id="StoneInventory.ViewSelectStone.ButtonNextPage">
<a class="viewcode-back" href="../../../src.cog.html#src.cog.inventory.StoneInventory.ViewSelectStone.ButtonNextPage">[ドキュメント]</a>
        <span class="k">class</span><span class="w"> </span><span class="nc">ButtonNextPage</span><span class="p">(</span><span class="n">discord</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">Button</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;一覧の次のページに移動するボタン。&quot;&quot;&quot;</span>
<div class="viewcode-block" id="StoneInventory.ViewSelectStone.ButtonNextPage.callback">
<a class="viewcode-back" href="../../../src.cog.html#src.cog.inventory.StoneInventory.ViewSelectStone.ButtonNextPage.callback">[ドキュメント]</a>
            <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">callback</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">interaction</span><span class="p">:</span> <span class="n">discord</span><span class="o">.</span><span class="n">Interaction</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">interaction</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">id</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">id</span><span class="p">:</span> <span class="k">return</span> <span class="k">await</span> <span class="n">interaction</span><span class="o">.</span><span class="n">response</span><span class="o">.</span><span class="n">defer</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">current_page</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">show_stone_list</span><span class="p">(</span><span class="n">interaction</span><span class="p">)</span></div>
</div>

        
<div class="viewcode-block" id="StoneInventory.ViewSelectStone.ButtonLastPage">
<a class="viewcode-back" href="../../../src.cog.html#src.cog.inventory.StoneInventory.ViewSelectStone.ButtonLastPage">[ドキュメント]</a>
        <span class="k">class</span><span class="w"> </span><span class="nc">ButtonLastPage</span><span class="p">(</span><span class="n">discord</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">Button</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;一覧の最後のページに移動するボタン。&quot;&quot;&quot;</span>
<div class="viewcode-block" id="StoneInventory.ViewSelectStone.ButtonLastPage.callback">
<a class="viewcode-back" href="../../../src.cog.html#src.cog.inventory.StoneInventory.ViewSelectStone.ButtonLastPage.callback">[ドキュメント]</a>
            <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">callback</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">interaction</span><span class="p">:</span> <span class="n">discord</span><span class="o">.</span><span class="n">Interaction</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">interaction</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">id</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">id</span><span class="p">:</span> <span class="k">return</span> <span class="k">await</span> <span class="n">interaction</span><span class="o">.</span><span class="n">response</span><span class="o">.</span><span class="n">defer</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">current_page</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">max_page</span>
                <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">show_stone_list</span><span class="p">(</span><span class="n">interaction</span><span class="p">)</span></div>
</div>


        <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">:</span> <span class="s2">&quot;StoneInventory&quot;</span><span class="p">,</span> <span class="n">stone_list</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">],</span> <span class="o">*</span><span class="p">,</span> <span class="n">timeout</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="mi">180</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;ViewSelectStoneのコンストラクタ。&quot;&quot;&quot;</span>
            <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">timeout</span><span class="o">=</span><span class="n">timeout</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">obj</span> <span class="o">=</span> <span class="n">obj</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">stone_list</span><span class="p">):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">add_item</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ButtonSelectStone</span><span class="p">(</span><span class="n">stone_list</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">style</span><span class="o">=</span><span class="n">discord</span><span class="o">.</span><span class="n">ButtonStyle</span><span class="o">.</span><span class="n">blurple</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">stone_list</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">add_item</span><span class="p">(</span><span class="n">discord</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="n">discord</span><span class="o">.</span><span class="n">ButtonStyle</span><span class="o">.</span><span class="n">gray</span><span class="p">,</span> <span class="n">disabled</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
            
            <span class="bp">self</span><span class="o">.</span><span class="n">select_filter</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">SelectFilter</span><span class="p">(</span><span class="n">placeholder</span><span class="o">=</span><span class="s2">&quot;フィルター&quot;</span><span class="p">,</span> <span class="n">min_values</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">max_values</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">game</span><span class="o">.</span><span class="n">StoneType</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">select_filter</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;[部位]</span><span class="si">{</span><span class="n">t</span><span class="o">.</span><span class="n">name_ja</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;type-</span><span class="si">{</span><span class="n">t</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;type-</span><span class="si">{</span><span class="n">t</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s2">&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">filters</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">game</span><span class="o">.</span><span class="n">StoneSet</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">select_filter</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;[セット]</span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">name_ja</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;set-</span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;set-</span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s2">&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">filters</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_item</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">select_filter</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">add_item</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ButtonTopPage</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;&lt;&lt;&quot;</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="n">discord</span><span class="o">.</span><span class="n">ButtonStyle</span><span class="o">.</span><span class="n">blurple</span><span class="p">,</span> <span class="n">disabled</span><span class="o">=</span><span class="n">obj</span><span class="o">.</span><span class="n">current_page</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_item</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ButtonPrevPage</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;&lt;&quot;</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="n">discord</span><span class="o">.</span><span class="n">ButtonStyle</span><span class="o">.</span><span class="n">blurple</span><span class="p">,</span> <span class="n">disabled</span><span class="o">=</span><span class="n">obj</span><span class="o">.</span><span class="n">current_page</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_item</span><span class="p">(</span><span class="n">discord</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">obj</span><span class="o">.</span><span class="n">current_page</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2"> / </span><span class="si">{</span><span class="nb">max</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">max_page</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">disabled</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_item</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ButtonNextPage</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;&gt;&quot;</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="n">discord</span><span class="o">.</span><span class="n">ButtonStyle</span><span class="o">.</span><span class="n">blurple</span><span class="p">,</span> <span class="n">disabled</span><span class="o">=</span><span class="n">obj</span><span class="o">.</span><span class="n">current_page</span> <span class="o">&gt;=</span> <span class="n">obj</span><span class="o">.</span><span class="n">max_page</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_item</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ButtonLastPage</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;&gt;&gt;&quot;</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="n">discord</span><span class="o">.</span><span class="n">ButtonStyle</span><span class="o">.</span><span class="n">blurple</span><span class="p">,</span> <span class="n">disabled</span><span class="o">=</span><span class="n">obj</span><span class="o">.</span><span class="n">current_page</span> <span class="o">&gt;=</span> <span class="n">obj</span><span class="o">.</span><span class="n">max_page</span><span class="p">))</span></div>


<div class="viewcode-block" id="StoneInventory.ViewStone">
<a class="viewcode-back" href="../../../src.cog.html#src.cog.inventory.StoneInventory.ViewStone">[ドキュメント]</a>
    <span class="k">class</span><span class="w"> </span><span class="nc">ViewStone</span><span class="p">(</span><span class="n">discord</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">View</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;ストーン詳細画面のView。「戻る」「ロック」「レベルアップ」「粉砕」ボタンを提供。&quot;&quot;&quot;</span>
        <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">:</span> <span class="s2">&quot;StoneInventory&quot;</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">timeout</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="mi">180</span><span class="p">):</span>
            <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">timeout</span><span class="o">=</span><span class="n">timeout</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">obj</span> <span class="o">=</span> <span class="n">obj</span>

<div class="viewcode-block" id="StoneInventory.ViewStone.ButtonBack">
<a class="viewcode-back" href="../../../src.cog.html#src.cog.inventory.StoneInventory.ViewStone.ButtonBack">[ドキュメント]</a>
        <span class="nd">@discord</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">button</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;Back&quot;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="n">discord</span><span class="o">.</span><span class="n">ButtonStyle</span><span class="o">.</span><span class="n">gray</span><span class="p">)</span>
        <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">ButtonBack</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">int</span><span class="p">:</span> <span class="n">discord</span><span class="o">.</span><span class="n">Interaction</span><span class="p">,</span> <span class="n">button</span><span class="p">:</span> <span class="n">discord</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">Button</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;一覧画面に戻ります。&quot;&quot;&quot;</span>
            <span class="k">if</span> <span class="nb">int</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">id</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">id</span><span class="p">:</span> <span class="k">await</span> <span class="nb">int</span><span class="o">.</span><span class="n">response</span><span class="o">.</span><span class="n">defer</span><span class="p">();</span> <span class="k">return</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">selected_stone</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">show_stone_list</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span></div>


<div class="viewcode-block" id="StoneInventory.ViewStone.ButtonLock">
<a class="viewcode-back" href="../../../src.cog.html#src.cog.inventory.StoneInventory.ViewStone.ButtonLock">[ドキュメント]</a>
        <span class="nd">@discord</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">button</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;ロック&quot;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="n">discord</span><span class="o">.</span><span class="n">ButtonStyle</span><span class="o">.</span><span class="n">blurple</span><span class="p">)</span>
        <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">ButtonLock</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">int</span><span class="p">:</span> <span class="n">discord</span><span class="o">.</span><span class="n">Interaction</span><span class="p">,</span> <span class="n">button</span><span class="p">:</span> <span class="n">discord</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">Button</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;ストーンのロック状態を切り替えます。&quot;&quot;&quot;</span>
            <span class="k">if</span> <span class="nb">int</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">id</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">id</span><span class="p">:</span> <span class="k">await</span> <span class="nb">int</span><span class="o">.</span><span class="n">response</span><span class="o">.</span><span class="n">defer</span><span class="p">();</span> <span class="k">return</span>
            <span class="n">stone_obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">selected_stone</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">stone_obj</span><span class="o">.</span><span class="n">is_lock</span> <span class="o">=</span> <span class="ow">not</span> <span class="n">stone_obj</span><span class="o">.</span><span class="n">is_lock</span>
            <span class="n">game</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">give_player_stone</span><span class="p">(</span><span class="nb">int</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">stone_obj</span><span class="p">)</span> <span class="c1"># is_lockの変更を保存</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">show_stone</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span></div>


<div class="viewcode-block" id="StoneInventory.ViewStone.ButtonLvUp">
<a class="viewcode-back" href="../../../src.cog.html#src.cog.inventory.StoneInventory.ViewStone.ButtonLvUp">[ドキュメント]</a>
        <span class="nd">@discord</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">button</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;Level Up&quot;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="n">discord</span><span class="o">.</span><span class="n">ButtonStyle</span><span class="o">.</span><span class="n">blurple</span><span class="p">)</span>
        <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">ButtonLvUp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">int</span><span class="p">:</span> <span class="n">discord</span><span class="o">.</span><span class="n">Interaction</span><span class="p">,</span> <span class="n">button</span><span class="p">:</span> <span class="n">discord</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">Button</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;レベルアップ画面に遷移します。&quot;&quot;&quot;</span>
            <span class="k">if</span> <span class="nb">int</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">id</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">id</span><span class="p">:</span> <span class="k">await</span> <span class="nb">int</span><span class="o">.</span><span class="n">response</span><span class="o">.</span><span class="n">defer</span><span class="p">();</span> <span class="k">return</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">selected_stone</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">lv</span> <span class="o">&gt;=</span> <span class="mi">15</span><span class="p">:</span>
                <span class="k">await</span> <span class="nb">int</span><span class="o">.</span><span class="n">response</span><span class="o">.</span><span class="n">send_message</span><span class="p">(</span><span class="s2">&quot;これ以上レベルアップできません。&quot;</span><span class="p">,</span> <span class="n">ephemeral</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="k">return</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">exp_item_count</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">show_lvup_stone</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span></div>

        
<div class="viewcode-block" id="StoneInventory.ViewStone.ButtonCrush">
<a class="viewcode-back" href="../../../src.cog.html#src.cog.inventory.StoneInventory.ViewStone.ButtonCrush">[ドキュメント]</a>
        <span class="nd">@discord</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">button</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;粉砕&quot;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="n">discord</span><span class="o">.</span><span class="n">ButtonStyle</span><span class="o">.</span><span class="n">red</span><span class="p">)</span>
        <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">ButtonCrush</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">int</span><span class="p">:</span> <span class="n">discord</span><span class="o">.</span><span class="n">Interaction</span><span class="p">,</span> <span class="n">button</span><span class="p">:</span> <span class="n">discord</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">Button</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;ストーンを粉砕して経験値アイテムに変換します。&quot;&quot;&quot;</span>
            <span class="k">if</span> <span class="nb">int</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">id</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">id</span><span class="p">:</span> <span class="k">await</span> <span class="nb">int</span><span class="o">.</span><span class="n">response</span><span class="o">.</span><span class="n">defer</span><span class="p">();</span> <span class="k">return</span>
            <span class="n">stone_obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">selected_stone</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">stone_obj</span><span class="o">.</span><span class="n">is_lock</span> <span class="ow">or</span> <span class="n">game</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">is_stone_using</span><span class="p">(</span><span class="nb">int</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">stone_obj</span><span class="o">.</span><span class="n">uuid</span><span class="p">):</span>
                <span class="k">await</span> <span class="nb">int</span><span class="o">.</span><span class="n">response</span><span class="o">.</span><span class="n">send_message</span><span class="p">(</span><span class="s2">&quot;ロック中または装備中のストーンは粉砕できません。&quot;</span><span class="p">,</span> <span class="n">ephemeral</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="k">return</span>
            
            <span class="c1"># 粉砕処理</span>
            <span class="n">exp_gain</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">stone_obj</span><span class="o">.</span><span class="n">convert_to_exp</span><span class="p">()</span> <span class="o">/</span> <span class="mi">250</span><span class="p">)</span>
            <span class="n">game</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">give_item</span><span class="p">(</span><span class="nb">int</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">exp_gain</span><span class="p">)</span>
            <span class="n">game</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">delete_player_stone</span><span class="p">(</span><span class="nb">int</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">stone_obj</span><span class="o">.</span><span class="n">uuid</span><span class="p">)</span>
            
            <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">selected_stone</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">update_stone_list</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span> <span class="c1"># 一覧を更新</span></div>
</div>


<div class="viewcode-block" id="StoneInventory.ViewLvUpStone">
<a class="viewcode-back" href="../../../src.cog.html#src.cog.inventory.StoneInventory.ViewLvUpStone">[ドキュメント]</a>
    <span class="k">class</span><span class="w"> </span><span class="nc">ViewLvUpStone</span><span class="p">(</span><span class="n">discord</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">View</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;ストーンレベルアップ画面のView。&quot;&quot;&quot;</span>
        <span class="c1"># ... (WeaponInventory.ViewLvUpWeaponと同様の実装) ...</span>
        <span class="k">pass</span></div>


    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;StoneInventoryセッションを初期化します。&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">user</span><span class="p">:</span> <span class="n">discord</span><span class="o">.</span><span class="n">User</span> <span class="o">|</span> <span class="n">discord</span><span class="o">.</span><span class="n">Member</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stone_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current_page</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">max_page</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">filters</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fil_type</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fil_set</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">selected_stone</span><span class="p">:</span> <span class="nb">list</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">exp_item_count</span> <span class="o">=</span> <span class="mi">0</span>

<div class="viewcode-block" id="StoneInventory.show_lvup_stone">
<a class="viewcode-back" href="../../../src.cog.html#src.cog.inventory.StoneInventory.show_lvup_stone">[ドキュメント]</a>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">show_lvup_stone</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">int</span><span class="p">:</span> <span class="n">discord</span><span class="o">.</span><span class="n">Interaction</span><span class="p">,</span> <span class="n">lvup_count</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;ストーンレベルアップ画面を表示します。&quot;&quot;&quot;</span>
        <span class="n">index</span><span class="p">,</span> <span class="n">stone</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">selected_stone</span>
        <span class="n">embed</span> <span class="o">=</span> <span class="n">discord</span><span class="o">.</span><span class="n">Embed</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;[レベルアップ] </span><span class="si">{</span><span class="n">index</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s1">. </span><span class="si">{</span><span class="n">stone</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;使用する</span><span class="si">{</span><span class="n">game</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">get_item_data_by_id</span><span class="p">(</span><span class="mi">2</span><span class="p">)[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1">の数：**</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">exp_item_count</span><span class="si">}</span><span class="s1">** / </span><span class="si">{</span><span class="n">game</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">get_player_item_count</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">discord</span><span class="o">.</span><span class="n">Colour</span><span class="o">.</span><span class="n">from_rgb</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">))</span>
        <span class="n">embed</span><span class="o">.</span><span class="n">add_field</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;レベル&quot;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">stone</span><span class="o">.</span><span class="n">lv</span><span class="si">}</span><span class="s1"> &gt;&gt; </span><span class="si">{</span><span class="n">stone</span><span class="o">.</span><span class="n">lv</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">lvup_count</span><span class="si">}</span><span class="s1"> / 15&#39;</span><span class="p">)</span>
        <span class="c1"># ViewLvUpStoneを正しくインスタンス化する必要がある</span>
        <span class="c1"># view = self.ViewLvUpStone(self)</span>
        <span class="c1"># await int.response.edit_message(embed=embed, attachments=[], view=view)</span>
        <span class="k">await</span> <span class="nb">int</span><span class="o">.</span><span class="n">response</span><span class="o">.</span><span class="n">edit_message</span><span class="p">(</span><span class="n">embed</span><span class="o">=</span><span class="n">embed</span><span class="p">,</span> <span class="n">attachments</span><span class="o">=</span><span class="p">[])</span></div>



<div class="viewcode-block" id="StoneInventory.calc_lvup">
<a class="viewcode-back" href="../../../src.cog.html#src.cog.inventory.StoneInventory.calc_lvup">[ドキュメント]</a>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">calc_lvup</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">interaction</span><span class="p">:</span> <span class="n">discord</span><span class="o">.</span><span class="n">Interaction</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;レベルアップに使用するアイテム数を計算し、画面を更新します。&quot;&quot;&quot;</span>
        <span class="n">index</span><span class="p">,</span> <span class="n">stone</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">selected_stone</span>
        <span class="n">lvup_count</span><span class="p">,</span> <span class="n">exp_item_count</span> <span class="o">=</span> <span class="n">stone</span><span class="o">.</span><span class="n">calc_lvup</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">exp_item_count</span> <span class="o">+</span> <span class="n">value</span><span class="p">,</span> <span class="n">game</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">get_player_item_count</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="mi">2</span><span class="p">)),</span> <span class="mi">0</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">exp_item_count</span> <span class="o">=</span> <span class="n">exp_item_count</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">show_lvup_stone</span><span class="p">(</span><span class="n">interaction</span><span class="p">,</span> <span class="n">lvup_count</span><span class="p">)</span></div>


<div class="viewcode-block" id="StoneInventory.lvup_stone">
<a class="viewcode-back" href="../../../src.cog.html#src.cog.inventory.StoneInventory.lvup_stone">[ドキュメント]</a>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">lvup_stone</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">int</span><span class="p">:</span> <span class="n">discord</span><span class="o">.</span><span class="n">Interaction</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;ストーンのレベルアップを確定させます。&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">game</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">give_item</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">exp_item_count</span><span class="p">):</span>
            <span class="k">return</span> <span class="k">await</span> <span class="nb">int</span><span class="o">.</span><span class="n">response</span><span class="o">.</span><span class="n">send_message</span><span class="p">(</span><span class="s2">&quot;アイテムが足りません&quot;</span><span class="p">,</span> <span class="n">ephemeral</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">index</span><span class="p">,</span> <span class="n">stone</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">selected_stone</span>
        <span class="n">stone</span><span class="o">.</span><span class="n">give_exp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">exp_item_count</span> <span class="o">*</span> <span class="mi">250</span><span class="p">)</span>
        <span class="n">game</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">give_player_stone</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">stone</span><span class="p">)</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">show_stone</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span></div>


<div class="viewcode-block" id="StoneInventory.show_stone">
<a class="viewcode-back" href="../../../src.cog.html#src.cog.inventory.StoneInventory.show_stone">[ドキュメント]</a>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">show_stone</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">int</span><span class="p">:</span> <span class="n">discord</span><span class="o">.</span><span class="n">Interaction</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;選択されたストーンの詳細を表示します。&quot;&quot;&quot;</span>
        <span class="n">index</span><span class="p">,</span> <span class="n">stone</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">selected_stone</span>
        <span class="n">file</span> <span class="o">=</span> <span class="n">discord</span><span class="o">.</span><span class="n">File</span><span class="p">(</span><span class="n">fp</span><span class="o">=</span><span class="n">utils</span><span class="o">.</span><span class="n">sys</span><span class="o">.</span><span class="n">get_game_path</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;asset/img/</span><span class="si">{</span><span class="n">stone</span><span class="o">.</span><span class="n">img_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">),</span> <span class="n">filename</span><span class="o">=</span><span class="s2">&quot;stone.png&quot;</span><span class="p">)</span>
        <span class="n">embed</span> <span class="o">=</span> <span class="n">discord</span><span class="o">.</span><span class="n">Embed</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">stone</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> lv.</span><span class="si">{</span><span class="n">stone</span><span class="o">.</span><span class="n">lv</span><span class="si">}{</span><span class="s1">&#39; 🔒&#39;</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">stone</span><span class="o">.</span><span class="n">is_lock</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;3セット：</span><span class="si">{</span><span class="n">stone</span><span class="o">.</span><span class="n">set</span><span class="o">.</span><span class="n">status</span><span class="o">.</span><span class="n">name_ja</span><span class="si">}</span><span class="s2"> +15%&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">discord</span><span class="o">.</span><span class="n">Colour</span><span class="o">.</span><span class="n">from_rgb</span><span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
        <span class="n">embed</span><span class="o">.</span><span class="n">set_image</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="s2">&quot;attachment://stone.png&quot;</span><span class="p">)</span>
        <span class="n">sop_value</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">sop</span><span class="o">.</span><span class="n">option</span><span class="o">.</span><span class="n">name_ja</span><span class="si">}</span><span class="s2">　　</span><span class="si">{</span><span class="n">sop</span><span class="o">.</span><span class="n">get_display_value</span><span class="p">()</span><span class="si">}</span><span class="se">\\</span><span class="s2">n&quot;</span> <span class="k">for</span> <span class="n">sop</span> <span class="ow">in</span> <span class="n">stone</span><span class="o">.</span><span class="n">sops</span><span class="p">])</span><span class="o">.</span><span class="n">rstrip</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">n&quot;</span><span class="p">)</span>
        <span class="n">embed</span><span class="o">.</span><span class="n">add_field</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">stone</span><span class="o">.</span><span class="n">mop</span><span class="o">.</span><span class="n">option</span><span class="o">.</span><span class="n">name_ja</span><span class="si">}</span><span class="s2">　　</span><span class="si">{</span><span class="n">stone</span><span class="o">.</span><span class="n">mop</span><span class="o">.</span><span class="n">get_display_value</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">sop_value</span><span class="p">)</span>
        
        <span class="n">view</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ViewStone</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="c1"># ボタンの状態を動的に変更</span>
        <span class="n">lock_button</span> <span class="o">=</span> <span class="p">[</span><span class="n">child</span> <span class="k">for</span> <span class="n">child</span> <span class="ow">in</span> <span class="n">view</span><span class="o">.</span><span class="n">children</span> <span class="k">if</span> <span class="n">child</span><span class="o">.</span><span class="n">label</span> <span class="o">==</span> <span class="s2">&quot;ロック&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">lock_button</span><span class="o">.</span><span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;ロック解除&quot;</span> <span class="k">if</span> <span class="n">stone</span><span class="o">.</span><span class="n">is_lock</span> <span class="k">else</span> <span class="s2">&quot;ロック&quot;</span>
        <span class="n">lock_button</span><span class="o">.</span><span class="n">style</span> <span class="o">=</span> <span class="n">discord</span><span class="o">.</span><span class="n">ButtonStyle</span><span class="o">.</span><span class="n">red</span> <span class="k">if</span> <span class="n">stone</span><span class="o">.</span><span class="n">is_lock</span> <span class="k">else</span> <span class="n">discord</span><span class="o">.</span><span class="n">ButtonStyle</span><span class="o">.</span><span class="n">blurple</span>
        
        <span class="n">crush_button</span> <span class="o">=</span> <span class="p">[</span><span class="n">child</span> <span class="k">for</span> <span class="n">child</span> <span class="ow">in</span> <span class="n">view</span><span class="o">.</span><span class="n">children</span> <span class="k">if</span> <span class="n">child</span><span class="o">.</span><span class="n">label</span> <span class="o">==</span> <span class="s2">&quot;粉砕&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">crush_button</span><span class="o">.</span><span class="n">disabled</span> <span class="o">=</span> <span class="n">stone</span><span class="o">.</span><span class="n">is_lock</span> <span class="ow">or</span> <span class="n">game</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">is_stone_using</span><span class="p">(</span><span class="nb">int</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">stone</span><span class="o">.</span><span class="n">uuid</span><span class="p">)</span>

        <span class="k">await</span> <span class="nb">int</span><span class="o">.</span><span class="n">response</span><span class="o">.</span><span class="n">edit_message</span><span class="p">(</span><span class="n">embed</span><span class="o">=</span><span class="n">embed</span><span class="p">,</span> <span class="n">attachments</span><span class="o">=</span><span class="p">[</span><span class="n">file</span><span class="p">],</span> <span class="n">view</span><span class="o">=</span><span class="n">view</span><span class="p">)</span></div>


<div class="viewcode-block" id="StoneInventory.show_stone_list">
<a class="viewcode-back" href="../../../src.cog.html#src.cog.inventory.StoneInventory.show_stone_list">[ドキュメント]</a>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">show_stone_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">interaction</span><span class="p">:</span> <span class="n">discord</span><span class="o">.</span><span class="n">Interaction</span><span class="p">,</span> <span class="n">is_send</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;ストーン一覧の指定ページを表示します。&quot;&quot;&quot;</span>
        <span class="n">stone_list_page</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">stone_list</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">current_page</span> <span class="o">*</span> <span class="mi">10</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_page</span> <span class="o">*</span> <span class="mi">10</span> <span class="o">+</span> <span class="mi">10</span><span class="p">]</span>
        <span class="n">description</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="sa">f</span><span class="s1">&#39;**</span><span class="si">{</span><span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s1">.** </span><span class="si">{</span><span class="n">s</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s1"> lv.</span><span class="si">{</span><span class="n">s</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">lv</span><span class="si">}{</span><span class="s2">&quot; 🔒&quot;</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">s</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">is_lock</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="si">}</span><span class="se">\\</span><span class="s1">n&#39;</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">stone_list_page</span><span class="p">])</span><span class="o">.</span><span class="n">rstrip</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">n&quot;</span><span class="p">)</span>
        <span class="n">embed</span> <span class="o">=</span> <span class="n">discord</span><span class="o">.</span><span class="n">Embed</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;所持ストーン一覧&quot;</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="n">description</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">discord</span><span class="o">.</span><span class="n">Colour</span><span class="o">.</span><span class="n">from_rgb</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">))</span>
        <span class="n">view</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ViewSelectStone</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">stone_list_page</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">is_send</span><span class="p">:</span>
            <span class="k">await</span> <span class="n">interaction</span><span class="o">.</span><span class="n">response</span><span class="o">.</span><span class="n">send_message</span><span class="p">(</span><span class="n">embed</span><span class="o">=</span><span class="n">embed</span><span class="p">,</span> <span class="n">view</span><span class="o">=</span><span class="n">view</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">await</span> <span class="n">interaction</span><span class="o">.</span><span class="n">response</span><span class="o">.</span><span class="n">edit_message</span><span class="p">(</span><span class="n">embed</span><span class="o">=</span><span class="n">embed</span><span class="p">,</span> <span class="n">attachments</span><span class="o">=</span><span class="p">[],</span> <span class="n">view</span><span class="o">=</span><span class="n">view</span><span class="p">)</span></div>


<div class="viewcode-block" id="StoneInventory.update_stone_list">
<a class="viewcode-back" href="../../../src.cog.html#src.cog.inventory.StoneInventory.update_stone_list">[ドキュメント]</a>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">update_stone_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">interaction</span><span class="p">:</span> <span class="n">discord</span><span class="o">.</span><span class="n">Interaction</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;フィルターを適用してストーン一覧を再生成・表示します。&quot;&quot;&quot;</span>
        <span class="n">is_send</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">user</span> <span class="ow">is</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">is_send</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">user</span> <span class="o">=</span> <span class="n">interaction</span><span class="o">.</span><span class="n">user</span>
        
        <span class="n">all_stones_data</span> <span class="o">=</span> <span class="n">game</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">get_player_all_stones_data</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
        <span class="n">stone_list_lock</span><span class="p">,</span> <span class="n">stone_list_normal</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">s_data</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">all_stones_data</span><span class="p">):</span>
            <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">fil_type</span> <span class="ow">or</span> <span class="n">s_data</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">]</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fil_type</span><span class="p">)</span> <span class="ow">and</span> \
               <span class="p">(</span><span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">fil_set</span> <span class="ow">or</span> <span class="n">s_data</span><span class="p">[</span><span class="s2">&quot;set&quot;</span><span class="p">]</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fil_set</span><span class="p">):</span>
                <span class="n">s_obj</span> <span class="o">=</span> <span class="n">game</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">get_player_stone</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">s_data</span><span class="p">[</span><span class="s2">&quot;uuid&quot;</span><span class="p">])</span>
                <span class="k">if</span> <span class="n">s_obj</span><span class="o">.</span><span class="n">is_lock</span><span class="p">:</span>
                    <span class="n">stone_list_lock</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">i</span><span class="p">,</span> <span class="n">s_obj</span><span class="p">])</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">stone_list_normal</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">i</span><span class="p">,</span> <span class="n">s_obj</span><span class="p">])</span>

        <span class="c1"># ロック済みのものを先に、レベル降順でソート</span>
        <span class="n">stone_list_lock</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">lv</span><span class="p">,</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">stone_list_normal</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">lv</span><span class="p">,</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stone_list</span> <span class="o">=</span> <span class="n">stone_list_lock</span> <span class="o">+</span> <span class="n">stone_list_normal</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">current_page</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">max_page</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stone_list</span><span class="p">)</span> <span class="o">/</span> <span class="mi">10</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">show_stone_list</span><span class="p">(</span><span class="n">interaction</span><span class="p">,</span> <span class="n">is_send</span><span class="p">)</span></div>
</div>



<div class="viewcode-block" id="InventoryCmd">
<a class="viewcode-back" href="../../../src.cog.html#src.cog.inventory.InventoryCmd">[ドキュメント]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">InventoryCmd</span><span class="p">(</span><span class="n">commands</span><span class="o">.</span><span class="n">Cog</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;インベントリ関連のスラッシュコマンドを定義するCog。&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bot</span><span class="p">:</span> <span class="n">commands</span><span class="o">.</span><span class="n">Bot</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;InventoryCmdのコンストラクタ。&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bot</span> <span class="o">=</span> <span class="n">bot</span>


    <span class="nd">@app_commands</span><span class="o">.</span><span class="n">command</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;character_inventory&quot;</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s2">&quot;所持しているキャラクターを見る&quot;</span><span class="p">)</span>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">character_inventory</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">int</span><span class="p">:</span> <span class="n">discord</span><span class="o">.</span><span class="n">Interaction</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;キャラクターインベントリを開始します。&quot;&quot;&quot;</span>
        <span class="k">await</span> <span class="n">CharacterInventory</span><span class="p">()</span><span class="o">.</span><span class="n">update_chara_list</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>


    <span class="nd">@app_commands</span><span class="o">.</span><span class="n">command</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;weapon_inventory&quot;</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s2">&quot;所持している武器を見る&quot;</span><span class="p">)</span>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">weapon_inventory</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">int</span><span class="p">:</span> <span class="n">discord</span><span class="o">.</span><span class="n">Interaction</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;武器インベントリを開始します。&quot;&quot;&quot;</span>
        <span class="k">await</span> <span class="n">WeaponInventory</span><span class="p">()</span><span class="o">.</span><span class="n">update_weapon_list</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>


    <span class="nd">@app_commands</span><span class="o">.</span><span class="n">command</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;stone_inventory&quot;</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s2">&quot;所持しているストーンを見る&quot;</span><span class="p">)</span>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">stone_inventory</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">int</span><span class="p">:</span> <span class="n">discord</span><span class="o">.</span><span class="n">Interaction</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;ストーンインベントリを開始します。&quot;&quot;&quot;</span>
        <span class="k">await</span> <span class="n">StoneInventory</span><span class="p">()</span><span class="o">.</span><span class="n">update_stone_list</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span></div>



<div class="viewcode-block" id="setup">
<a class="viewcode-back" href="../../../src.cog.html#src.cog.inventory.setup">[ドキュメント]</a>
<span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">setup</span><span class="p">(</span><span class="n">bot</span><span class="p">:</span> <span class="n">commands</span><span class="o">.</span><span class="n">Bot</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;CogをBotに登録するためのセットアップ関数。&quot;&quot;&quot;</span>
    <span class="k">await</span> <span class="n">bot</span><span class="o">.</span><span class="n">add_cog</span><span class="p">(</span><span class="n">InventoryCmd</span><span class="p">(</span><span class="n">bot</span><span class="p">))</span></div>


</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, qr0.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>